<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<!-- Generated by rfcdiff 1.41: rfcdiff  --> 
<!-- <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional" > -->
<!-- System: Linux rfcpa 2.6.27.45-0.1-xen #1 SMP 2010-02-22 16:49:47 +0100 x86_64 x86_64 x86_64 GNU/Linux --> 
<!-- Using awk: /usr/bin/gawk: GNU Awk 3.1.6 --> 
<!-- Using diff: /usr/bin/diff: diff (GNU diffutils) 2.8.7-cvs --> 
<!-- Using wdiff: /usr/bin/wdiff: GNU 0.5.2 L3 --> 
<html> 
<head> 
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /> 
  <meta http-equiv="Content-Style-Type" content="text/css" /> 
  <title>Diff: draft-ietf-tcpm-1323bis-05_v2output.txt - draft-ietf-tcpm-1323bis-05_v2fromnroff.txt</title> 
  <style type="text/css"> 
    body    { margin: 0.4ex; margin-right: auto; } 
    tr      { } 
    td      { white-space: pre; font-family: monospace; vertical-align: top; font-size: 0.86em;} 
    th      { font-size: 0.86em; } 
    .small  { font-size: 0.6em; font-style: italic; font-family: Verdana, Helvetica, sans-serif; } 
    .left   { background-color: #EEE; } 
    .right  { background-color: #FFF; } 
    .diff   { background-color: #CCF; } 
    .lblock { background-color: #BFB; } 
    .rblock { background-color: #FF8; } 
    .insert { background-color: #8FF; } 
    .delete { background-color: #ACF; } 
    .void   { background-color: #FFB; } 
    .cont   { background-color: #EEE; } 
    .linebr { background-color: #AAA; } 
    .lineno { color: red; background-color: #FFF; font-size: 0.7em; text-align: right; padding: 0 2px; } 
    .elipsis{ background-color: #AAA; } 
    .left .cont { background-color: #DDD; } 
    .right .cont { background-color: #EEE; } 
    .lblock .cont { background-color: #9D9; } 
    .rblock .cont { background-color: #DD6; } 
    .insert .cont { background-color: #0DD; } 
    .delete .cont { background-color: #8AD; } 
    .stats, .stats td, .stats th { background-color: #EEE; padding: 2px 0; } 
  </style> 
</head> 
<body > 
  <table border="0" cellpadding="0" cellspacing="0"> 
  <tr bgcolor="orange"><th></th><th>&nbsp;draft-ietf-tcpm-1323bis-05_v2output.txt&nbsp;</th><th> </th><th>&nbsp;draft-ietf-tcpm-1323bis-05_v2fromnroff.txt&nbsp;</th><th></th></tr> 
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l1" /><small>skipping to change at</small><em> page 2, line 6</em></th><th> </th><th><a name="part-r1" /><small>skipping to change at</small><em> page 2, line 23</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   material or to cite them other than as "work in progress."</td><td> </td><td class="right">   material or to cite them other than as "work in progress."</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   This Internet-Draft will expire on August 24, 2013.</td><td> </td><td class="right">   This Internet-Draft will expire on August 24, 2013.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Copyright Notice</td><td> </td><td class="right">Copyright Notice</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Copyright (c) 2013 IETF Trust and the persons identified as the</td><td> </td><td class="right">   Copyright (c) 2013 IETF Trust and the persons identified as the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   document authors.  All rights reserved.</td><td> </td><td class="right">   document authors.  All rights reserved.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   This document is subject to BCP 78 and the IETF Trust's Legal</td><td> </td><td class="right">   This document is subject to BCP 78 and the IETF Trust's Legal</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0001" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Provisions Relating to IETF Documents</td><td> </td><td class="rblock">   Provisions Relating to IETF Documents <span class="insert">(-</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">(http://trustee.ietf.org/license-info)</span> in effect on the date of</td><td> </td><td class="rblock"><span class="insert">   http://trustee.ietf.org/license-info)</span> in effect on the date of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   publication of this document.  Please review these documents</td><td> </td><td class="right">   publication of this document.  Please review these documents</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   carefully, as they describe your rights and restrictions with respect</td><td> </td><td class="right">   carefully, as they describe your rights and restrictions with respect</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   to this document.  Code Components extracted from this document must</td><td> </td><td class="right">   to this document.  Code Components extracted from this document must</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   include Simplified BSD License text as described in Section 4.e of</td><td> </td><td class="right">   include Simplified BSD License text as described in Section 4.e of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the Trust Legal Provisions and are provided without warranty as</td><td> </td><td class="right">   the Trust Legal Provisions and are provided without warranty as</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   described in the Simplified BSD License.</td><td> </td><td class="right">   described in the Simplified BSD License.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0002" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">Table of Contents</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   3</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">     1.1.  TCP Performance . . . . . . . . . . . . . . . . . . . . .   3</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">     1.2.  TCP Reliability . . . . . . . . . . . . . . . . . . . . .   4</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">     1.3.  Using TCP options . . . . . . . . . . . . . . . . . . . .   5</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   2.  Terminology . . . . . . . . . . . . . . . . . . . . . . . . .   6</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   3.  TCP Window Scale Option . . . . . . . . . . . . . . . . . . .   6</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">     3.1.  Introduction  . . . . . . . . . . . . . . . . . . . . . .   6</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">     3.2.  Window Scale Option . . . . . . . . . . . . . . . . . . .   6</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">     3.3.  Using the Window Scale Option . . . . . . . . . . . . . .   7</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">     3.4.  Addressing Window Retraction  . . . . . . . . . . . . . .   9</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   4.  RTTM -- Round-Trip Time Measurement . . . . . . . . . . . . .  11</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">     4.1.  Introduction  . . . . . . . . . . . . . . . . . . . . . .  11</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">     4.2.  TCP Timestamps Option . . . . . . . . . . . . . . . . . .  12</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">     4.3.  The RTTM Mechanism  . . . . . . . . . . . . . . . . . . .  13</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">     4.4.  Which Timestamp to Echo . . . . . . . . . . . . . . . . .  14</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   5.  PAWS -- Protection Against Wrapped Sequence Numbers . . . . .  17</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">     5.1.  Introduction  . . . . . . . . . . . . . . . . . . . . . .  17</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">     5.2.  The PAWS Mechanism  . . . . . . . . . . . . . . . . . . .  17</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       5.2.1.  Basic PAWS Algorithm  . . . . . . . . . . . . . . . .  18</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       5.2.2.  Timestamp Clock . . . . . . . . . . . . . . . . . . .  20</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       5.2.3.  Outdated Timestamps . . . . . . . . . . . . . . . . .  22</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       5.2.4.  Header Prediction . . . . . . . . . . . . . . . . . .  22</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       5.2.5.  IP Fragmentation  . . . . . . . . . . . . . . . . . .  24</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">     5.3.  Duplicates from Earlier Incarnations of Connection  . . .  24</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   6.  Conclusions and Acknowledgements  . . . . . . . . . . . . . .  25</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   7.  Security Considerations . . . . . . . . . . . . . . . . . . .  25</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   8.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .  26</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   9.  References  . . . . . . . . . . . . . . . . . . . . . . . . .  26</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">     9.1.  Normative References  . . . . . . . . . . . . . . . . . .  26</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">     9.2.  Informative References  . . . . . . . . . . . . . . . . .  26</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   Appendix A.  Implementation Suggestions . . . . . . . . . . . . .  28</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   Appendix B.  Duplicates from Earlier Connection Incarnations  . .  29</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">     B.1.  System Crash with Loss of State . . . . . . . . . . . . .  29</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">     B.2.  Closing and Reopening a Connection  . . . . . . . . . . .  30</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   Appendix C.  Summary of Notation  . . . . . . . . . . . . . . . .  31</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   Appendix D.  Pseudo-code Summary  . . . . . . . . . . . . . . . .  32</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   Appendix E.  Event Processing Summary . . . . . . . . . . . . . .  34</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   Appendix F.  Timestamps Edge Cases  . . . . . . . . . . . . . . .  40</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   Appendix G.  Changes from RFC 1072, RFC 1185, and RFC 1323  . . .  40</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  43</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">1.  Introduction</td><td> </td><td class="right">1.  Introduction</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The TCP protocol [RFC0793] was designed to operate reliably over</td><td> </td><td class="right">   The TCP protocol [RFC0793] was designed to operate reliably over</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   almost any transmission medium regardless of transmission rate,</td><td> </td><td class="right">   almost any transmission medium regardless of transmission rate,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   delay, corruption, duplication, or reordering of segments.  Over the</td><td> </td><td class="right">   delay, corruption, duplication, or reordering of segments.  Over the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   years, advances in networking technology has resulted in ever-higher</td><td> </td><td class="right">   years, advances in networking technology has resulted in ever-higher</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   transmission speeds, and the fastest paths are well beyond the domain</td><td> </td><td class="right">   transmission speeds, and the fastest paths are well beyond the domain</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   for which TCP was originally engineered.</td><td> </td><td class="right">   for which TCP was originally engineered.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   This document defines a set of modest extensions to TCP to extend the</td><td> </td><td class="right">   This document defines a set of modest extensions to TCP to extend the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l2" /><small>skipping to change at</small><em> page 8, line 25</em></th><th> </th><th><a name="part-r2" /><small>skipping to change at</small><em> page 11, line 38</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   o  Upon receiving a SYN segment with a Window Scale option containing</td><td> </td><td class="right">   o  Upon receiving a SYN segment with a Window Scale option containing</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      shift.cnt = S, a TCP sets Snd.Wind.Scale to S and sets</td><td> </td><td class="right">      shift.cnt = S, a TCP sets Snd.Wind.Scale to S and sets</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Rcv.Wind.Scale to R; otherwise, it sets both Snd.Wind.Scale and</td><td> </td><td class="right">      Rcv.Wind.Scale to R; otherwise, it sets both Snd.Wind.Scale and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Rcv.Wind.Scale to zero.</td><td> </td><td class="right">      Rcv.Wind.Scale to zero.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   o  The window field (SEG.WND) in the header of every incoming</td><td> </td><td class="right">   o  The window field (SEG.WND) in the header of every incoming</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      segment, with the exception of SYN segments, is left-shifted by</td><td> </td><td class="right">      segment, with the exception of SYN segments, is left-shifted by</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Snd.Wind.Scale bits before updating SND.WND:</td><td> </td><td class="right">      Snd.Wind.Scale bits before updating SND.WND:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0003" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                    SND.WND = SEG.WND &lt;&lt; Snd.Wind.Scale</td><td> </td><td class="rblock">                    <span class="insert"> </span>SND.WND = SEG.WND &lt;&lt; Snd.Wind.Scale</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      (assuming the other conditions of [RFC0793] are met, and using the</td><td> </td><td class="right">      (assuming the other conditions of [RFC0793] are met, and using the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      "C" notation "&lt;&lt;" for left-shift).</td><td> </td><td class="right">      "C" notation "&lt;&lt;" for left-shift).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   o  The window field (SEG.WND) of every outgoing segment, with the</td><td> </td><td class="right">   o  The window field (SEG.WND) of every outgoing segment, with the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      exception of SYN segments, is right-shifted by Rcv.Wind.Scale</td><td> </td><td class="right">      exception of SYN segments, is right-shifted by Rcv.Wind.Scale</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      bits:</td><td> </td><td class="right">      bits:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0004" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                    SND.WND = RCV.WND &gt;&gt; Rcv.Wind.Scale</td><td> </td><td class="rblock">                    <span class="insert"> </span>SND.WND = RCV.WND &gt;&gt; Rcv.Wind.Scale</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TCP determines if a data segment is "old" or "new" by testing whether</td><td> </td><td class="right">   TCP determines if a data segment is "old" or "new" by testing whether</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   its sequence number is within 2^31 bytes of the left edge of the</td><td> </td><td class="right">   its sequence number is within 2^31 bytes of the left edge of the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   window, and if it is not, discarding the data as "old".  To insure</td><td> </td><td class="right">   window, and if it is not, discarding the data as "old".  To insure</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   that new data is never mistakenly considered old and vice versa, the</td><td> </td><td class="right">   that new data is never mistakenly considered old and vice versa, the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   left edge of the sender's window has to be at most 2^31 away from the</td><td> </td><td class="right">   left edge of the sender's window has to be at most 2^31 away from the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   right edge of the receiver's window.  Similarly with the sender's</td><td> </td><td class="right">   right edge of the receiver's window.  Similarly with the sender's</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   right edge and receiver's left edge.  Since the right and left edges</td><td> </td><td class="right">   right edge and receiver's left edge.  Since the right and left edges</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   of either the sender's or receiver's window differ by the window</td><td> </td><td class="right">   of either the sender's or receiver's window differ by the window</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   size, and since the sender and receiver windows can be out of phase</td><td> </td><td class="right">   size, and since the sender and receiver windows can be out of phase</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   by at most the window size, the above constraints imply that two</td><td> </td><td class="right">   by at most the window size, the above constraints imply that two</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   times the max window size must be less than 2^31, or</td><td> </td><td class="right">   times the max window size must be less than 2^31, or</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0005" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                             max window &lt; 2^30</td><td> </td><td class="rblock">                             <span class="insert"> </span>max window &lt; 2^30</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Since the max window is 2^S (where S is the scaling shift count)</td><td> </td><td class="right">   Since the max window is 2^S (where S is the scaling shift count)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   times at most 2^16 - 1 (the maximum unscaled window), the maximum</td><td> </td><td class="right">   times at most 2^16 - 1 (the maximum unscaled window), the maximum</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   window is guaranteed to be &lt; 2^30 if S &lt;= 14.  Thus, the shift count</td><td> </td><td class="right">   window is guaranteed to be &lt; 2^30 if S &lt;= 14.  Thus, the shift count</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   MUST be limited to 14 (which allows windows of 2^30 = 1 Gbyte).  If a</td><td> </td><td class="right">   MUST be limited to 14 (which allows windows of 2^30 = 1 Gbyte).  If a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Window Scale option is received with a shift.cnt value exceeding 14,</td><td> </td><td class="right">   Window Scale option is received with a shift.cnt value exceeding 14,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the TCP SHOULD log the error but use 14 instead of the specified</td><td> </td><td class="right">   the TCP SHOULD log the error but use 14 instead of the specified</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   value.</td><td> </td><td class="right">   value.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The scale factor applies only to the Window field as transmitted in</td><td> </td><td class="right">   The scale factor applies only to the Window field as transmitted in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l3" /><small>skipping to change at</small><em> page 13, line 31</em></th><th> </th><th><a name="part-r3" /><small>skipping to change at</small><em> page 17, line 5</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   a TSecr value.  However, these values cannot all be used to update</td><td> </td><td class="right">   a TSecr value.  However, these values cannot all be used to update</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the measured RTT.  The following example illustrates why.  It shows a</td><td> </td><td class="right">   the measured RTT.  The following example illustrates why.  It shows a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   one-way data flow with segments arriving in sequence without loss.</td><td> </td><td class="right">   one-way data flow with segments arriving in sequence without loss.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Here A, B, C... represent data blocks occupying successive blocks of</td><td> </td><td class="right">   Here A, B, C... represent data blocks occupying successive blocks of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   sequence numbers, and ACK(A),...  represent the corresponding</td><td> </td><td class="right">   sequence numbers, and ACK(A),...  represent the corresponding</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   cumulative acknowledgments.  The two timestamp fields of the</td><td> </td><td class="right">   cumulative acknowledgments.  The two timestamp fields of the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Timestamps option are shown symbolically as &lt;TSval=x,TSecr=y&gt;.  Each</td><td> </td><td class="right">   Timestamps option are shown symbolically as &lt;TSval=x,TSecr=y&gt;.  Each</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TSecr field contains the value most recently received in a TSval</td><td> </td><td class="right">   TSecr field contains the value most recently received in a TSval</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   field.</td><td> </td><td class="right">   field.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0006" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">             TCP  A                                     TCP B</td><td> </td><td class="rblock">             <span class="insert">  </span>TCP  A                                     TCP B</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0007" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                             &lt;A,TSval=1,TSecr=120&gt; -----&gt;</td><td> </td><td class="rblock">                             <span class="insert">  </span>&lt;A,TSval=1,TSecr=120&gt; -----&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0008" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                  &lt;---- &lt;ACK(A),TSval=127,TSecr=1&gt;</td><td> </td><td class="rblock">                  <span class="insert">  </span>&lt;---- &lt;ACK(A),TSval=127,TSecr=1&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0009" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                             &lt;B,TSval=5,TSecr=127&gt; -----&gt;</td><td> </td><td class="rblock">                             <span class="insert">  </span>&lt;B,TSval=5,TSecr=127&gt; -----&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0010" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                  &lt;---- &lt;ACK(B),TSval=131,TSecr=5&gt;</td><td> </td><td class="rblock">                  <span class="insert">  </span>&lt;---- &lt;ACK(B),TSval=131,TSecr=5&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0011" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               . . . . . . . . . . . . . . . . . . . . . .</td><td> </td><td class="rblock">               <span class="insert">  </span>. . . . . . . . . . . . . . . . . . . . . .</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0012" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                             &lt;C,TSval=65,TSecr=131&gt; ----&gt;</td><td> </td><td class="rblock">                             <span class="insert">  </span>&lt;C,TSval=65,TSecr=131&gt; ----&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0013" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                  &lt;---- &lt;ACK(C),TSval=191,TSecr=65&gt;</td><td> </td><td class="rblock">                  <span class="insert">  </span>&lt;---- &lt;ACK(C),TSval=191,TSecr=65&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0014" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                 (etc.)</td><td> </td><td class="rblock">                                 <span class="insert">  </span>(etc.)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The dotted line marks a pause (60 time units long) in which A had</td><td> </td><td class="right">   The dotted line marks a pause (60 time units long) in which A had</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   nothing to send.  Note that this pause inflates the RTT which B could</td><td> </td><td class="right">   nothing to send.  Note that this pause inflates the RTT which B could</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   infer from receiving TSecr=131 in data segment C.  Thus, in one-way</td><td> </td><td class="right">   infer from receiving TSecr=131 in data segment C.  Thus, in one-way</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   data flows, RTTM in the reverse direction measures a value that is</td><td> </td><td class="right">   data flows, RTTM in the reverse direction measures a value that is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   inflated by gaps in sending data.  However, the following rule</td><td> </td><td class="right">   inflated by gaps in sending data.  However, the following rule</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   prevents a resulting inflation of the measured RTT:</td><td> </td><td class="right">   prevents a resulting inflation of the measured RTT:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      RTTM Rule: A TSecr value received in a segment is used to update</td><td> </td><td class="right">      RTTM Rule: A TSecr value received in a segment is used to update</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      the averaged RTT measurement only if</td><td> </td><td class="right">      the averaged RTT measurement only if</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l4" /><small>skipping to change at</small><em> page 15, line 43</em></th><th> </th><th><a name="part-r4" /><small>skipping to change at</small><em> page 20, line 18</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (1)  The connection state is augmented with two 32-bit slots:</td><td> </td><td class="right">   (1)  The connection state is augmented with two 32-bit slots:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      TS.Recent holds a timestamp to be echoed in TSecr whenever a</td><td> </td><td class="right">      TS.Recent holds a timestamp to be echoed in TSecr whenever a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      segment is sent, and Last.ACK.sent holds the ACK field from the</td><td> </td><td class="right">      segment is sent, and Last.ACK.sent holds the ACK field from the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      last segment sent.  Last.ACK.sent will equal RCV.NXT except when</td><td> </td><td class="right">      last segment sent.  Last.ACK.sent will equal RCV.NXT except when</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      ACKs have been delayed.</td><td> </td><td class="right">      ACKs have been delayed.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (2)  If:</td><td> </td><td class="right">   (2)  If:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0015" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">            SEG.TSval &gt;= TS.recent and SEG.SEQ &lt;= Last.ACK.sent</td><td> </td><td class="rblock">            <span class="insert"> </span>SEG.TSval &gt;= TS.recent and SEG.SEQ &lt;= Last.ACK.sent</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      then SEG.TSval is copied to TS.Recent; otherwise, it is ignored.</td><td> </td><td class="right">      then SEG.TSval is copied to TS.Recent; otherwise, it is ignored.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (3)  When a TSopt is sent, its TSecr field is set to the current</td><td> </td><td class="right">   (3)  When a TSopt is sent, its TSecr field is set to the current</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      TS.Recent value.</td><td> </td><td class="right">      TS.Recent value.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The following examples illustrate these rules.  Here A, B, C...</td><td> </td><td class="right">   The following examples illustrate these rules.  Here A, B, C...</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   represent data segments occupying successive blocks of sequence</td><td> </td><td class="right">   represent data segments occupying successive blocks of sequence</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   numbers, and ACK(A),...  represent the corresponding acknowledgment</td><td> </td><td class="right">   numbers, and ACK(A),...  represent the corresponding acknowledgment</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   segments.  Note that ACK(A) has the same sequence number as B.  We</td><td> </td><td class="right">   segments.  Note that ACK(A) has the same sequence number as B.  We</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   show only one direction of timestamp echoing, for clarity.</td><td> </td><td class="right">   show only one direction of timestamp echoing, for clarity.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   o  Packets arrive in sequence, and some of the ACKs are delayed.</td><td> </td><td class="right">   o  Packets arrive in sequence, and some of the ACKs are delayed.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      By case (A), the timestamp from the oldest unacknowledged segment</td><td> </td><td class="right">      By case (A), the timestamp from the oldest unacknowledged segment</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      is echoed.</td><td> </td><td class="right">      is echoed.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0016" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                  TS.Recent</td><td> </td><td class="rblock">                                                   TS.Recent</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                &lt;A, TSval=1&gt; -------------------&gt;</td><td> </td><td class="rblock">                 &lt;A, TSval=1&gt; -------------------&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                      1</td><td> </td><td class="rblock">                                                       1</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                &lt;B, TSval=2&gt; -------------------&gt;</td><td> </td><td class="rblock">                 &lt;B, TSval=2&gt; -------------------&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                      1</td><td> </td><td class="rblock">                                                       1</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                &lt;C, TSval=3&gt; -------------------&gt;</td><td> </td><td class="rblock">                 &lt;C, TSval=3&gt; -------------------&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                      1</td><td> </td><td class="rblock">                                                       1</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                         &lt;---- &lt;ACK(C), TSecr=1&gt;</td><td> </td><td class="rblock">                          &lt;---- &lt;ACK(C), TSecr=1&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                (etc)</td><td> </td><td class="rblock">                 (etc)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   o  Packets arrive out of order, and every packet is acknowledged.</td><td> </td><td class="right">   o  Packets arrive out of order, and every packet is acknowledged.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      By case (B), the timestamp from the last segment that advanced the</td><td> </td><td class="right">      By case (B), the timestamp from the last segment that advanced the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      left window edge is echoed, until the missing segment arrives; it</td><td> </td><td class="right">      left window edge is echoed, until the missing segment arrives; it</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      is echoed according to Case (C).  The same sequence would occur if</td><td> </td><td class="right">      is echoed according to Case (C).  The same sequence would occur if</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      segments B and D were lost and retransmitted.</td><td> </td><td class="right">      segments B and D were lost and retransmitted.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0017" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                  TS.Recent</td><td> </td><td class="rblock">                                                   TS.Recent</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                &lt;A, TSval=1&gt; -------------------&gt;</td><td> </td><td class="rblock">                 &lt;A, TSval=1&gt; -------------------&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                      1</td><td> </td><td class="rblock">                                                       1</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                         &lt;---- &lt;ACK(A), TSecr=1&gt;</td><td> </td><td class="rblock">                          &lt;---- &lt;ACK(A), TSecr=1&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                      1</td><td> </td><td class="rblock">                                                       1</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                &lt;C, TSval=3&gt; -------------------&gt;</td><td> </td><td class="rblock">                 &lt;C, TSval=3&gt; -------------------&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                      1</td><td> </td><td class="rblock">                                                       1</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                         &lt;---- &lt;ACK(A), TSecr=1&gt;</td><td> </td><td class="rblock">                          &lt;---- &lt;ACK(A), TSecr=1&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                      1</td><td> </td><td class="rblock">                                                       1</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                &lt;B, TSval=2&gt; -------------------&gt;</td><td> </td><td class="rblock">                 &lt;B, TSval=2&gt; -------------------&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                      2</td><td> </td><td class="rblock">                                                       2</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                         &lt;---- &lt;ACK(C), TSecr=2&gt;</td><td> </td><td class="rblock">                          &lt;---- &lt;ACK(C), TSecr=2&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                      2</td><td> </td><td class="rblock">                                                       2</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                &lt;E, TSval=5&gt; -------------------&gt;</td><td> </td><td class="rblock">                 &lt;E, TSval=5&gt; -------------------&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                      2</td><td> </td><td class="rblock">                                                       2</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                         &lt;---- &lt;ACK(C), TSecr=2&gt;</td><td> </td><td class="rblock">                          &lt;---- &lt;ACK(C), TSecr=2&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                      2</td><td> </td><td class="rblock">                                                       2</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                &lt;D, TSval=4&gt; -------------------&gt;</td><td> </td><td class="rblock">                 &lt;D, TSval=4&gt; -------------------&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                      4</td><td> </td><td class="rblock">                                                       4</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                         &lt;---- &lt;ACK(E), TSecr=4&gt;</td><td> </td><td class="rblock">                          &lt;---- &lt;ACK(E), TSecr=4&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock">                 (etc)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                (etc)</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">5.  PAWS -- Protection Against Wrapped Sequence Numbers</td><td> </td><td class="right">5.  PAWS -- Protection Against Wrapped Sequence Numbers</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">5.1.  Introduction</td><td> </td><td class="right">5.1.  Introduction</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0018" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                                                                         </span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Section 5.2 describes a simple mechanism to reject old duplicate</td><td> </td><td class="right">   Section 5.2 describes a simple mechanism to reject old duplicate</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   segments that might corrupt an open TCP connection; we call this</td><td> </td><td class="right">   segments that might corrupt an open TCP connection; we call this</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   mechanism PAWS (Protection Against Wrapped Sequence numbers).  PAWS</td><td> </td><td class="right">   mechanism PAWS (Protection Against Wrapped Sequence numbers).  PAWS</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   operates within a single TCP connection, using state that is saved in</td><td> </td><td class="right">   operates within a single TCP connection, using state that is saved in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the connection control block.  Section 5.3 and Appendix G discuss the</td><td> </td><td class="right">   the connection control block.  Section 5.3 and Appendix G discuss the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   implications of the PAWS mechanism for avoiding old duplicates from</td><td> </td><td class="right">   implications of the PAWS mechanism for avoiding old duplicates from</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   previous incarnations of the same connection.</td><td> </td><td class="right">   previous incarnations of the same connection.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">5.2.  The PAWS Mechanism</td><td> </td><td class="right">5.2.  The PAWS Mechanism</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l5" /><small>skipping to change at</small><em> page 17, line 34</em></th><th> </th><th><a name="part-r5" /><small>skipping to change at</small><em> page 22, line 27</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   whose values are monotonically non-decreasing in time.  The basic</td><td> </td><td class="right">   whose values are monotonically non-decreasing in time.  The basic</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   idea is that a segment can be discarded as an old duplicate if it is</td><td> </td><td class="right">   idea is that a segment can be discarded as an old duplicate if it is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   received with a timestamp SEG.TSval less than some timestamp recently</td><td> </td><td class="right">   received with a timestamp SEG.TSval less than some timestamp recently</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   received on this connection.</td><td> </td><td class="right">   received on this connection.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   In both the PAWS and the RTTM mechanism, the "timestamps" are 32-bit</td><td> </td><td class="right">   In both the PAWS and the RTTM mechanism, the "timestamps" are 32-bit</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   unsigned integers in a modular 32-bit space.  Thus, "less than" is</td><td> </td><td class="right">   unsigned integers in a modular 32-bit space.  Thus, "less than" is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   defined the same way it is for TCP sequence numbers, and the same</td><td> </td><td class="right">   defined the same way it is for TCP sequence numbers, and the same</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   implementation techniques apply.  If s and t are timestamp values,</td><td> </td><td class="right">   implementation techniques apply.  If s and t are timestamp values,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0019" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                       s &lt; t  if 0 &lt; (t - s) &lt; 2^31,</td><td> </td><td class="rblock">                       <span class="insert"> </span>s &lt; t  if 0 &lt; (t - s) &lt; 2^31,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   computed in unsigned 32-bit arithmetic.</td><td> </td><td class="right">   computed in unsigned 32-bit arithmetic.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The choice of incoming timestamps to be saved for this comparison</td><td> </td><td class="right">   The choice of incoming timestamps to be saved for this comparison</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   MUST guarantee a value that is monotonically increasing.  For</td><td> </td><td class="right">   MUST guarantee a value that is monotonically increasing.  For</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   example, we might save the timestamp from the segment that last</td><td> </td><td class="right">   example, we might save the timestamp from the segment that last</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   advanced the left edge of the receive window, i.e., the most recent</td><td> </td><td class="right">   advanced the left edge of the receive window, i.e., the most recent</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   in-sequence segment.  Instead, we choose the value TS.Recent</td><td> </td><td class="right">   in-sequence segment.  Instead, we choose the value TS.Recent</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   introduced in Section 4.4 for the RTTM mechanism, since using a</td><td> </td><td class="right">   introduced in Section 4.4 for the RTTM mechanism, since using a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   common value for both PAWS and RTTM simplifies the implementation of</td><td> </td><td class="right">   common value for both PAWS and RTTM simplifies the implementation of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l6" /><small>skipping to change at</small><em> page 26, line 40</em></th><th> </th><th><a name="part-r6" /><small>skipping to change at</small><em> page 34, line 18</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">9.2.  Informative References</td><td> </td><td class="right">9.2.  Informative References</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [Garlick77]</td><td> </td><td class="right">   [Garlick77]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Garlick, L., Rom, R., and J. Postel, "Issues in Reliable</td><td> </td><td class="right">              Garlick, L., Rom, R., and J. Postel, "Issues in Reliable</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Host-to-Host Protocols", Proc. Second Berkeley Workshop on</td><td> </td><td class="right">              Host-to-Host Protocols", Proc. Second Berkeley Workshop on</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Distributed Data Management and Computer Networks, May</td><td> </td><td class="right">              Distributed Data Management and Computer Networks, May</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              1977, &lt;http://www.rfc-editor.org/ien/ien12.txt&gt;.</td><td> </td><td class="right">              1977, &lt;http://www.rfc-editor.org/ien/ien12.txt&gt;.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [Hamming77]</td><td> </td><td class="right">   [Hamming77]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Hamming, R., "Digital Filters", Prentice Hall, Englewood</td><td> </td><td class="right">              Hamming, R., "Digital Filters", Prentice Hall, Englewood</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0020" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              Cliffs, N.J. ISBN 0-13-212571-4, 1977.</td><td> </td><td class="rblock">              Cliffs, N.J. <span class="insert"> </span>ISBN 0-13-212571-4, 1977.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [Jacobson88a]</td><td> </td><td class="right">   [Jacobson88a]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Jacobson, V., "Congestion Avoidance and Control", SIGCOMM</td><td> </td><td class="right">              Jacobson, V., "Congestion Avoidance and Control", SIGCOMM</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              '88, Stanford, CA., August 1988,</td><td> </td><td class="right">              '88, Stanford, CA., August 1988,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              &lt;http://ee.lbl.gov/papers/congavoid.pdf&gt;.</td><td> </td><td class="right">              &lt;http://ee.lbl.gov/papers/congavoid.pdf&gt;.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [Jacobson90a]</td><td> </td><td class="right">   [Jacobson90a]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Jacobson, V., "4BSD Header Prediction", ACM Computer</td><td> </td><td class="right">              Jacobson, V., "4BSD Header Prediction", ACM Computer</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Communication Review, April 1990.</td><td> </td><td class="right">              Communication Review, April 1990.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l7" /><small>skipping to change at</small><em> page 27, line 20</em></th><th> </th><th><a name="part-r7" /><small>skipping to change at</small><em> page 34, line 46</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Retransmissions", Proc. Fifth Phoenix Conf. on Comp. and</td><td> </td><td class="right">              Retransmissions", Proc. Fifth Phoenix Conf. on Comp. and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Comm., Scottsdale, Arizona, March 1986,</td><td> </td><td class="right">              Comm., Scottsdale, Arizona, March 1986,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              &lt;http://arxiv.org/ftp/cs/papers/9809/9809097.pdf&gt;.</td><td> </td><td class="right">              &lt;http://arxiv.org/ftp/cs/papers/9809/9809097.pdf&gt;.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [Karn87]   Karn, P. and C. Partridge, "Estimating Round-Trip Times in</td><td> </td><td class="right">   [Karn87]   Karn, P. and C. Partridge, "Estimating Round-Trip Times in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Reliable Transport Protocols", Proc. SIGCOMM '87, August</td><td> </td><td class="right">              Reliable Transport Protocols", Proc. SIGCOMM '87, August</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              1987.</td><td> </td><td class="right">              1987.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [Martin03]</td><td> </td><td class="right">   [Martin03]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Martin, D., "[Tsvwg] RFC 1323.bis", Message to the tsvwg</td><td> </td><td class="right">              Martin, D., "[Tsvwg] RFC 1323.bis", Message to the tsvwg</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0021" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              mailing list, September 2003, &lt;http://www.ietf.org/mail-</td><td> </td><td class="rblock">              mailing</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">              list, September 2003, &lt;http://www.ietf.org/mail-</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              archive/web/tsvwg/current/msg04435.html&gt;.</td><td> </td><td class="right">              archive/web/tsvwg/current/msg04435.html&gt;.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [Mathis08]</td><td> </td><td class="right">   [Mathis08]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Mathis, M., "[tcpm] Example of 1323 window retraction</td><td> </td><td class="right">              Mathis, M., "[tcpm] Example of 1323 window retraction</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              problem", Message to the tcpm mailing list, March 2008,</td><td> </td><td class="right">              problem", Message to the tcpm mailing list, March 2008,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              &lt;http://www.ietf.org/mail-archive/web/tcpm/current/</td><td> </td><td class="right">              &lt;http://www.ietf.org/mail-archive/web/tcpm/current/</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              msg03564.html&gt;.</td><td> </td><td class="right">              msg03564.html&gt;.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [RFC0896]  Nagle, J., "Congestion control in IP/TCP internetworks",</td><td> </td><td class="right">   [RFC0896]  Nagle, J., "Congestion control in IP/TCP internetworks",</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              RFC 896, January 1984.</td><td> </td><td class="right">              RFC 896, January 1984.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l8" /><small>skipping to change at</small><em> page 28, line 45</em></th><th> </th><th><a name="part-r8" /><small>skipping to change at</small><em> page 36, line 35</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              '86, Stowe, VT, August 1986.</td><td> </td><td class="right">              '86, Stowe, VT, August 1986.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Appendix A.  Implementation Suggestions</td><td> </td><td class="right">Appendix A.  Implementation Suggestions</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TCP Option Layout</td><td> </td><td class="right">   TCP Option Layout</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      The following layouts are recommended for sending options on non-</td><td> </td><td class="right">      The following layouts are recommended for sending options on non-</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      SYN segments, to achieve maximum feasible alignment of 32-bit and</td><td> </td><td class="right">      SYN segments, to achieve maximum feasible alignment of 32-bit and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      64-bit machines.</td><td> </td><td class="right">      64-bit machines.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0022" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                   +--------+--------+--------+--------+</td><td> </td><td class="rblock">                    +--------+--------+--------+--------+</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                   |   NOP  |  NOP   |  TSopt |   10   |</td><td> </td><td class="rblock">                    |   NOP  |  NOP   |  TSopt |   10   |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                   +--------+--------+--------+--------+</td><td> </td><td class="rblock">                    +--------+--------+--------+--------+</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                   |          TSval timestamp          |</td><td> </td><td class="rblock">                    |          TSval timestamp          |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                   +--------+--------+--------+--------+</td><td> </td><td class="rblock">                    +--------+--------+--------+--------+</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                   |          TSecr timestamp          |</td><td> </td><td class="rblock">                    |          TSecr timestamp          |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                   +--------+--------+--------+--------+</td><td> </td><td class="rblock">                    +--------+--------+--------+--------+</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Interaction with the TCP Urgent Pointer</td><td> </td><td class="right">   Interaction with the TCP Urgent Pointer</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      The TCP Urgent pointer, like the TCP window, is a 16 bit value.</td><td> </td><td class="right">      The TCP Urgent pointer, like the TCP window, is a 16 bit value.</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0023" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      Some of the original discussion for the TCP Window Scale option</td><td> </td><td class="rblock">      Some</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">      of the original discussion for the TCP Window Scale option</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      included proposals to increase the Urgent pointer to 32 bits.  As</td><td> </td><td class="right">      included proposals to increase the Urgent pointer to 32 bits.  As</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      it turns out, this is unnecessary.  There are two observations</td><td> </td><td class="right">      it turns out, this is unnecessary.  There are two observations</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      that should be made:</td><td> </td><td class="right">      that should be made:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      (1)  With IP Version 4, the largest amount of TCP data that can be</td><td> </td><td class="right">      (1)  With IP Version 4, the largest amount of TCP data that can be</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            sent in a single packet is 65495 bytes (64K - 1 -- size of</td><td> </td><td class="right">            sent in a single packet is 65495 bytes (64K - 1 -- size of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            fixed IP and TCP headers).</td><td> </td><td class="right">            fixed IP and TCP headers).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      (2)  Updates to the urgent pointer while the user is in "urgent</td><td> </td><td class="right">      (2)  Updates to the urgent pointer while the user is in "urgent</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            mode" are invisible to the user.</td><td> </td><td class="right">            mode" are invisible to the user.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l9" /><small>skipping to change at</small><em> page 30, line 9</em></th><th> </th><th><a name="part-r9" /><small>skipping to change at</small><em> page 38, line 5</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   for example "When to Keep Quiet" in the TCP protocol specification</td><td> </td><td class="right">   for example "When to Keep Quiet" in the TCP protocol specification</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [RFC0793].  The MSL that is required here does not depend upon the</td><td> </td><td class="right">   [RFC0793].  The MSL that is required here does not depend upon the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   transfer speed.  The current TCP MSL of 2 minutes seems acceptable as</td><td> </td><td class="right">   transfer speed.  The current TCP MSL of 2 minutes seems acceptable as</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   an operational compromise, as many host systems take this long to</td><td> </td><td class="right">   an operational compromise, as many host systems take this long to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   boot after a crash.</td><td> </td><td class="right">   boot after a crash.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   However, the timestamp option may be used to ease the MSL</td><td> </td><td class="right">   However, the timestamp option may be used to ease the MSL</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   requirements (or to provide additional security against data</td><td> </td><td class="right">   requirements (or to provide additional security against data</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   corruption).  If timestamps are being used and if the timestamp clock</td><td> </td><td class="right">   corruption).  If timestamps are being used and if the timestamp clock</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   can be guaranteed to be monotonic over a system crash/restart, i.e.,</td><td> </td><td class="right">   can be guaranteed to be monotonic over a system crash/restart, i.e.,</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0024" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   if the first value of the sender's timestamp clock after a <span class="delete">crash/</span></td><td> </td><td class="rblock">   if the first value of the sender's timestamp clock after a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   restart</span> can be guaranteed to be greater than the last value before</td><td> </td><td class="rblock">   <span class="insert">crash/restart</span> can be guaranteed to be greater than the last value</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   the restart, then a quiet time will be unnecessary.</td><td> </td><td class="rblock">   before the restart, then a quiet time will be unnecessary.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   To dispense totally with the quiet time would require that the host</td><td> </td><td class="right">   To dispense totally with the quiet time would require that the host</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0025" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   clock be synchronized to a time source that is stable over the <span class="delete">crash/</span></td><td> </td><td class="rblock">   clock be synchronized to a time source that is stable over the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   restart</span> period, with an accuracy of one timestamp clock tick or</td><td> </td><td class="rblock">   <span class="insert">crash/restart</span> period, with an accuracy of one timestamp clock tick or</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   better.  We can back off from this strict requirement to take</td><td> </td><td class="right">   better.  We can back off from this strict requirement to take</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   advantage of approximate clock synchronization.  Suppose that the</td><td> </td><td class="right">   advantage of approximate clock synchronization.  Suppose that the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   clock is always re-synchronized to within N timestamp clock ticks and</td><td> </td><td class="right">   clock is always re-synchronized to within N timestamp clock ticks and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   that booting (extended with a quiet time, if necessary) takes more</td><td> </td><td class="right">   that booting (extended with a quiet time, if necessary) takes more</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   than N ticks.  This will guarantee monotonicity of the timestamps,</td><td> </td><td class="right">   than N ticks.  This will guarantee monotonicity of the timestamps,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   which can then be used to reject old duplicates even without an</td><td> </td><td class="right">   which can then be used to reject old duplicates even without an</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   enforced MSL.</td><td> </td><td class="right">   enforced MSL.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">B.2.  Closing and Reopening a Connection</td><td> </td><td class="right">B.2.  Closing and Reopening a Connection</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l10" /><small>skipping to change at</small><em> page 34, line 40</em></th><th> </th><th><a name="part-r10" /><small>skipping to change at</small><em> page 45, line 39</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                else</td><td> </td><td class="right">                else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                      Update_SRTT( /* for compatibility */</td><td> </td><td class="right">                      Update_SRTT( /* for compatibility */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                             (Snd.TSclock - Start.Time)/my.TSclock.rate);</td><td> </td><td class="right">                             (Snd.TSclock - Start.Time)/my.TSclock.rate);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          }</td><td> </td><td class="right">          }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      }</td><td> </td><td class="right">      }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Appendix E.  Event Processing Summary</td><td> </td><td class="right">Appendix E.  Event Processing Summary</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   OPEN Call</td><td> </td><td class="right">   OPEN Call</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0026" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      <span class="delete">...</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      An initial send sequence number (ISS) is selected.  Send a SYN</td><td> </td><td class="right">      An initial send sequence number (ISS) is selected.  Send a SYN</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      segment of the form:</td><td> </td><td class="right">      segment of the form:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0027" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        &lt;SEQ=ISS&gt;&lt;CTL=SYN&gt;&lt;TSval=Snd.TSclock&gt;&lt;WSopt=Rcv.Wind.Scale&gt;</td><td> </td><td class="rblock">         &lt;SEQ=ISS&gt;&lt;CTL=SYN&gt;&lt;TSval=Snd.TSclock&gt;&lt;WSopt=Rcv.Wind.Scale&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      <span class="delete">...</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   SEND Call</td><td> </td><td class="right">   SEND Call</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      CLOSED STATE (i.e., TCB does not exist)</td><td> </td><td class="right">      CLOSED STATE (i.e., TCB does not exist)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0028" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">         <span class="delete">...</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      LISTEN STATE</td><td> </td><td class="right">      LISTEN STATE</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">         If the foreign socket is specified, then change the connection</td><td> </td><td class="right">         If the foreign socket is specified, then change the connection</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">         from passive to active, select an ISS.  Send a SYN segment</td><td> </td><td class="right">         from passive to active, select an ISS.  Send a SYN segment</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">         containing the options: &lt;TSval=Snd.TSclock&gt; and</td><td> </td><td class="right">         containing the options: &lt;TSval=Snd.TSclock&gt; and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">         &lt;WSopt=Rcv.Wind.Scale&gt;.  Set SND.UNA to ISS, SND.NXT to ISS+1.</td><td> </td><td class="right">         &lt;WSopt=Rcv.Wind.Scale&gt;.  Set SND.UNA to ISS, SND.NXT to ISS+1.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">         Enter SYN-SENT state.  ...</td><td> </td><td class="right">         Enter SYN-SENT state.  ...</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      SYN-SENT STATE</td><td> </td><td class="right">      SYN-SENT STATE</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      SYN-RECEIVED STATE</td><td> </td><td class="right">      SYN-RECEIVED STATE</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0029" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">         <span class="delete">...</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      ESTABLISHED STATE</td><td> </td><td class="right">      ESTABLISHED STATE</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      CLOSE-WAIT STATE</td><td> </td><td class="right">      CLOSE-WAIT STATE</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">         Segmentize the buffer and send it with a piggybacked</td><td> </td><td class="right">         Segmentize the buffer and send it with a piggybacked</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">         acknowledgment (acknowledgment value = RCV.NXT).  ...</td><td> </td><td class="right">         acknowledgment (acknowledgment value = RCV.NXT).  ...</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">         If the urgent flag is set ...</td><td> </td><td class="right">         If the urgent flag is set ...</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">         If the Snd.TS.OK flag is set, then include the TCP Timestamps</td><td> </td><td class="right">         If the Snd.TS.OK flag is set, then include the TCP Timestamps</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">         option &lt;TSval=Snd.TSclock,TSecr=TS.Recent&gt; in each data</td><td> </td><td class="right">         option &lt;TSval=Snd.TSclock,TSecr=TS.Recent&gt; in each data</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">         segment.</td><td> </td><td class="right">         segment.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">         Scale the receive window for transmission in the segment</td><td> </td><td class="right">         Scale the receive window for transmission in the segment</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">         header:</td><td> </td><td class="right">         header:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0030" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                  SEG.WND = (RCV.WND &gt;&gt; Rcv.Wind.Scale).</td><td> </td><td class="rblock">                  <span class="insert">  </span>SEG.WND = (RCV.WND &gt;&gt; Rcv.Wind.Scale).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   SEGMENT ARRIVES</td><td> </td><td class="right">   SEGMENT ARRIVES</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0031" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      <span class="delete">...</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      If the state is LISTEN then</td><td> </td><td class="right">      If the state is LISTEN then</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">         first check for an RST</td><td> </td><td class="right">         first check for an RST</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0032" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">            <span class="delete">...</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">         second check for an ACK</td><td> </td><td class="right">         second check for an ACK</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0033" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">            <span class="delete">...</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">         third check for a SYN</td><td> </td><td class="right">         third check for a SYN</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            if the SYN bit is set, check the security.  If the ...</td><td> </td><td class="right">            if the SYN bit is set, check the security.  If the ...</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0034" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">...</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            if the SEG.PRC is less than the TCB.PRC then continue.</td><td> </td><td class="right">            if the SEG.PRC is less than the TCB.PRC then continue.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            Check for a Window Scale option (WSopt); if one is found,</td><td> </td><td class="right">            Check for a Window Scale option (WSopt); if one is found,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            save SEG.WSopt in Snd.Wind.Scale and set Snd.WS.OK flag on.</td><td> </td><td class="right">            save SEG.WSopt in Snd.Wind.Scale and set Snd.WS.OK flag on.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            Otherwise, set both Snd.Wind.Scale and Rcv.Wind.Scale to</td><td> </td><td class="right">            Otherwise, set both Snd.Wind.Scale and Rcv.Wind.Scale to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            zero and clear Snd.WS.OK flag.</td><td> </td><td class="right">            zero and clear Snd.WS.OK flag.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            Check for a TSopt option; if one is found, save SEG.TSval in</td><td> </td><td class="right">            Check for a TSopt option; if one is found, save SEG.TSval in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            the variable TS.Recent and turn on the Snd.TS.OK bit.</td><td> </td><td class="right">            the variable TS.Recent and turn on the Snd.TS.OK bit.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            Set RCV.NXT to SEG.SEQ+1, IRS is set to SEG.SEQ and any</td><td> </td><td class="right">            Set RCV.NXT to SEG.SEQ+1, IRS is set to SEG.SEQ and any</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            other control or text should be queued for processing later.</td><td> </td><td class="right">            other control or text should be queued for processing later.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            ISS should be selected and a SYN segment sent of the form:</td><td> </td><td class="right">            ISS should be selected and a SYN segment sent of the form:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0035" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                    &lt;SEQ=ISS&gt;&lt;ACK=RCV.NXT&gt;&lt;CTL=SYN,ACK&gt;</td><td> </td><td class="rblock">                    <span class="insert"> </span>&lt;SEQ=ISS&gt;&lt;ACK=RCV.NXT&gt;&lt;CTL=SYN,ACK&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            If the Snd.WS.OK bit is on, include a WSopt option</td><td> </td><td class="right">            If the Snd.WS.OK bit is on, include a WSopt option</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            &lt;WSopt=Rcv.Wind.Scale&gt; in this segment.  If the Snd.TS.OK</td><td> </td><td class="right">            &lt;WSopt=Rcv.Wind.Scale&gt; in this segment.  If the Snd.TS.OK</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            bit is on, include a TSopt</td><td> </td><td class="right">            bit is on, include a TSopt</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            &lt;TSval=Snd.TSclock,TSecr=TS.Recent&gt; in this segment.</td><td> </td><td class="right">            &lt;TSval=Snd.TSclock,TSecr=TS.Recent&gt; in this segment.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            Last.ACK.sent is set to RCV.NXT.</td><td> </td><td class="right">            Last.ACK.sent is set to RCV.NXT.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            SND.NXT is set to ISS+1 and SND.UNA to ISS.  The connection</td><td> </td><td class="right">            SND.NXT is set to ISS+1 and SND.UNA to ISS.  The connection</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            state should be changed to SYN-RECEIVED.  Note that any</td><td> </td><td class="right">            state should be changed to SYN-RECEIVED.  Note that any</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            other incoming control or data (combined with SYN) will be</td><td> </td><td class="right">            other incoming control or data (combined with SYN) will be</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            processed in the SYN-RECEIVED state, but processing of SYN</td><td> </td><td class="right">            processed in the SYN-RECEIVED state, but processing of SYN</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            and ACK should not be repeated.  If the listen was not fully</td><td> </td><td class="right">            and ACK should not be repeated.  If the listen was not fully</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            specified (i.e., the foreign socket was not fully</td><td> </td><td class="right">            specified (i.e., the foreign socket was not fully</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            specified), then the unspecified fields should be filled in</td><td> </td><td class="right">            specified), then the unspecified fields should be filled in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            now.</td><td> </td><td class="right">            now.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">         fourth other text or control</td><td> </td><td class="right">         fourth other text or control</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0036" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">            <span class="delete">...</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      If the state is SYN-SENT then</td><td> </td><td class="right">      If the state is SYN-SENT then</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">         first check the ACK bit</td><td> </td><td class="right">         first check the ACK bit</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0037" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">            <span class="delete">...</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">         ...</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">         fourth check the SYN bit</td><td> </td><td class="right">         fourth check the SYN bit</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0038" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">            <span class="delete">...</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            If the SYN bit is on and the security/compartment and</td><td> </td><td class="right">            If the SYN bit is on and the security/compartment and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            precedence are acceptable then, RCV.NXT is set to SEG.SEQ+1,</td><td> </td><td class="right">            precedence are acceptable then, RCV.NXT is set to SEG.SEQ+1,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            IRS is set to SEG.SEQ, and any acknowledgements on the</td><td> </td><td class="right">            IRS is set to SEG.SEQ, and any acknowledgements on the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            retransmission queue which are thereby acknowledged should</td><td> </td><td class="right">            retransmission queue which are thereby acknowledged should</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            be removed.</td><td> </td><td class="right">            be removed.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            Check for a Window Scale option (WSopt); if it is found,</td><td> </td><td class="right">            Check for a Window Scale option (WSopt); if it is found,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            save SEG.WSopt in Snd.Wind.Scale; otherwise, set both</td><td> </td><td class="right">            save SEG.WSopt in Snd.Wind.Scale; otherwise, set both</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            Snd.Wind.Scale and Rcv.Wind.Scale to zero.</td><td> </td><td class="right">            Snd.Wind.Scale and Rcv.Wind.Scale to zero.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            Check for a TSopt option; if one is found, save SEG.TSval in</td><td> </td><td class="right">            Check for a TSopt option; if one is found, save SEG.TSval in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            variable TS.Recent and turn on the Snd.TS.OK bit in the</td><td> </td><td class="right">            variable TS.Recent and turn on the Snd.TS.OK bit in the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            connection control block.  If the ACK bit is set, use</td><td> </td><td class="right">            connection control block.  If the ACK bit is set, use</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            Snd.TSclock - SEG.TSecr as the initial RTT estimate.</td><td> </td><td class="right">            Snd.TSclock - SEG.TSecr as the initial RTT estimate.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            If SND.UNA &gt; ISS (our SYN has been ACKed), change the</td><td> </td><td class="right">            If SND.UNA &gt; ISS (our SYN has been ACKed), change the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            connection state to ESTABLISHED, form an ACK segment:</td><td> </td><td class="right">            connection state to ESTABLISHED, form an ACK segment:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0039" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                    &lt;SEQ=SND.NXT&gt;&lt;ACK=RCV.NXT&gt;&lt;CTL=ACK&gt;</td><td> </td><td class="rblock">                    <span class="insert"> </span>&lt;SEQ=SND.NXT&gt;&lt;ACK=RCV.NXT&gt;&lt;CTL=ACK&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            and send it.  If the Snd.Echo.OK bit is on, include a TSopt</td><td> </td><td class="right">            and send it.  If the Snd.Echo.OK bit is on, include a TSopt</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            option &lt;TSval=Snd.TSclock,TSecr=TS.Recent&gt; in this ACK</td><td> </td><td class="right">            option &lt;TSval=Snd.TSclock,TSecr=TS.Recent&gt; in this ACK</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            segment.  Last.ACK.sent is set to RCV.NXT.</td><td> </td><td class="right">            segment.  Last.ACK.sent is set to RCV.NXT.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            Data or controls which were queued for transmission may be</td><td> </td><td class="right">            Data or controls which were queued for transmission may be</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            included.  If there are other controls or text in the</td><td> </td><td class="right">            included.  If there are other controls or text in the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            segment then continue processing at the sixth step below</td><td> </td><td class="right">            segment then continue processing at the sixth step below</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            where the URG bit is checked, otherwise return.</td><td> </td><td class="right">            where the URG bit is checked, otherwise return.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            Otherwise enter SYN-RECEIVED, form a SYN,ACK segment:</td><td> </td><td class="right">            Otherwise enter SYN-RECEIVED, form a SYN,ACK segment:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0040" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                    &lt;SEQ=ISS&gt;&lt;ACK=RCV.NXT&gt;&lt;CTL=SYN,ACK&gt;</td><td> </td><td class="rblock">                    <span class="insert"> </span>&lt;SEQ=ISS&gt;&lt;ACK=RCV.NXT&gt;&lt;CTL=SYN,ACK&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            and send it.  If the Snd.Echo.OK bit is on, include a TSopt</td><td> </td><td class="right">            and send it.  If the Snd.Echo.OK bit is on, include a TSopt</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            option &lt;TSval=Snd.TSclock,TSecr=TS.Recent&gt; in this segment.</td><td> </td><td class="right">            option &lt;TSval=Snd.TSclock,TSecr=TS.Recent&gt; in this segment.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            If the Snd.WS.OK bit is on, include a WSopt option</td><td> </td><td class="right">            If the Snd.WS.OK bit is on, include a WSopt option</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            &lt;WSopt=Rcv.Wind.Scale&gt; in this segment.  Last.ACK.sent is</td><td> </td><td class="right">            &lt;WSopt=Rcv.Wind.Scale&gt; in this segment.  Last.ACK.sent is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            set to RCV.NXT.</td><td> </td><td class="right">            set to RCV.NXT.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            If there are other controls or text in the segment, queue</td><td> </td><td class="right">            If there are other controls or text in the segment, queue</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            them for processing after the ESTABLISHED state has been</td><td> </td><td class="right">            them for processing after the ESTABLISHED state has been</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            reached, return.</td><td> </td><td class="right">            reached, return.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l11" /><small>skipping to change at</small><em> page 38, line 33</em></th><th> </th><th><a name="part-r11" /><small>skipping to change at</small><em> page 50, line 7</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">         TIME-WAIT STATE</td><td> </td><td class="right">         TIME-WAIT STATE</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            Segments are processed in sequence.  Initial tests on</td><td> </td><td class="right">            Segments are processed in sequence.  Initial tests on</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            arrival are used to discard old duplicates, but further</td><td> </td><td class="right">            arrival are used to discard old duplicates, but further</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            processing is done in SEG.SEQ order.  If a segment's</td><td> </td><td class="right">            processing is done in SEG.SEQ order.  If a segment's</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            contents straddle the boundary between old and new, only the</td><td> </td><td class="right">            contents straddle the boundary between old and new, only the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            new parts should be processed.</td><td> </td><td class="right">            new parts should be processed.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            Rescale the received window field:</td><td> </td><td class="right">            Rescale the received window field:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0041" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                  TrueWindow = SEG.WND &lt;&lt; Snd.Wind.Scale,</td><td> </td><td class="rblock">                  <span class="insert"> </span>TrueWindow = SEG.WND &lt;&lt; Snd.Wind.Scale,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            and use "TrueWindow" in place of SEG.WND in the following</td><td> </td><td class="right">            and use "TrueWindow" in place of SEG.WND in the following</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            steps.</td><td> </td><td class="right">            steps.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            Check whether the segment contains a Timestamps option and</td><td> </td><td class="right">            Check whether the segment contains a Timestamps option and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            bit Snd.TS.OK is on.  If so:</td><td> </td><td class="right">            bit Snd.TS.OK is on.  If so:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               If SEG.TSval &lt; TS.Recent and the RST bit is off, then</td><td> </td><td class="right">               If SEG.TSval &lt; TS.Recent and the RST bit is off, then</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               test whether connection has been idle less than 24 days;</td><td> </td><td class="right">               test whether connection has been idle less than 24 days;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               if all are true, then the segment is not acceptable;</td><td> </td><td class="right">               if all are true, then the segment is not acceptable;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               follow steps below for an unacceptable segment.</td><td> </td><td class="right">               follow steps below for an unacceptable segment.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               If SEG.SEQ is less than or equal to Last.ACK.sent, then</td><td> </td><td class="right">               If SEG.SEQ is less than or equal to Last.ACK.sent, then</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               save SEG.TSval in variable TS.Recent.</td><td> </td><td class="right">               save SEG.TSval in variable TS.Recent.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            There are four cases for the acceptability test for an</td><td> </td><td class="right">            There are four cases for the acceptability test for an</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            incoming segment:</td><td> </td><td class="right">            incoming segment:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0042" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete">...</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            If an incoming segment is not acceptable, an acknowledgment</td><td> </td><td class="right">            If an incoming segment is not acceptable, an acknowledgment</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            should be sent in reply (unless the RST bit is set, if so</td><td> </td><td class="right">            should be sent in reply (unless the RST bit is set, if so</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            drop the segment and return):</td><td> </td><td class="right">            drop the segment and return):</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0043" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                    &lt;SEQ=SND.NXT&gt;&lt;ACK=RCV.NXT&gt;&lt;CTL=ACK&gt;</td><td> </td><td class="rblock">                    <span class="insert"> </span>&lt;SEQ=SND.NXT&gt;&lt;ACK=RCV.NXT&gt;&lt;CTL=ACK&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            Last.ACK.sent is set to SEG.ACK of the acknowledgment.  If</td><td> </td><td class="right">            Last.ACK.sent is set to SEG.ACK of the acknowledgment.  If</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            the Snd.Echo.OK bit is on, include the Timestamps option</td><td> </td><td class="right">            the Snd.Echo.OK bit is on, include the Timestamps option</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            &lt;TSval=Snd.TSclock,TSecr=TS.Recent&gt; in this ACK segment.</td><td> </td><td class="right">            &lt;TSval=Snd.TSclock,TSecr=TS.Recent&gt; in this ACK segment.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            Set Last.ACK.sent to SEG.ACK and send the ACK segment.</td><td> </td><td class="right">            Set Last.ACK.sent to SEG.ACK and send the ACK segment.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            After sending the acknowledgment, drop the unacceptable</td><td> </td><td class="right">            After sending the acknowledgment, drop the unacceptable</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            segment and return.</td><td> </td><td class="right">            segment and return.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0044" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      <span class="delete">...</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      fifth check the ACK field.</td><td> </td><td class="right">      fifth check the ACK field.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">         if the ACK bit is off drop the segment and return.</td><td> </td><td class="right">         if the ACK bit is off drop the segment and return.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">         if the ACK bit is on</td><td> </td><td class="right">         if the ACK bit is on</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0045" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">            <span class="delete">...</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            ESTABLISHED STATE</td><td> </td><td class="right">            ESTABLISHED STATE</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               If SND.UNA &lt; SEG.ACK &lt;= SND.NXT then, set SND.UNA &lt;-</td><td> </td><td class="right">               If SND.UNA &lt; SEG.ACK &lt;= SND.NXT then, set SND.UNA &lt;-</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               SEG.ACK.  Also compute a new estimate of round-trip time.</td><td> </td><td class="right">               SEG.ACK.  Also compute a new estimate of round-trip time.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               If Snd.TS.OK bit is on, use Snd.TSclock - SEG.TSecr;</td><td> </td><td class="right">               If Snd.TS.OK bit is on, use Snd.TSclock - SEG.TSecr;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               otherwise use the elapsed time since the first segment in</td><td> </td><td class="right">               otherwise use the elapsed time since the first segment in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               the retransmission queue was sent.  Any segments on the</td><td> </td><td class="right">               the retransmission queue was sent.  Any segments on the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               retransmission queue which are thereby entirely</td><td> </td><td class="right">               retransmission queue which are thereby entirely</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               acknowledged...</td><td> </td><td class="right">               acknowledged...</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0046" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      <span class="delete">...</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Seventh, process the segment text.</td><td> </td><td class="right">      Seventh, process the segment text.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">         ESTABLISHED STATE</td><td> </td><td class="right">         ESTABLISHED STATE</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">         FIN-WAIT-1 STATE</td><td> </td><td class="right">         FIN-WAIT-1 STATE</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">         FIN-WAIT-2 STATE</td><td> </td><td class="right">         FIN-WAIT-2 STATE</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0047" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">            <span class="delete">...</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            Send an acknowledgment of the form:</td><td> </td><td class="right">            Send an acknowledgment of the form:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0048" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                    &lt;SEQ=SND.NXT&gt;&lt;ACK=RCV.NXT&gt;&lt;CTL=ACK&gt;</td><td> </td><td class="rblock">                    <span class="insert"> </span>&lt;SEQ=SND.NXT&gt;&lt;ACK=RCV.NXT&gt;&lt;CTL=ACK&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            If the Snd.TS.OK bit is on, include Timestamps option</td><td> </td><td class="right">            If the Snd.TS.OK bit is on, include Timestamps option</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            &lt;TSval=Snd.TSclock,TSecr=TS.Recent&gt; in this ACK segment.</td><td> </td><td class="right">            &lt;TSval=Snd.TSclock,TSecr=TS.Recent&gt; in this ACK segment.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            Set Last.ACK.sent to SEG.ACK of the acknowledgment, and send</td><td> </td><td class="right">            Set Last.ACK.sent to SEG.ACK of the acknowledgment, and send</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            it.  This acknowledgment should be piggy-backed on a segment</td><td> </td><td class="right">            it.  This acknowledgment should be piggy-backed on a segment</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            being transmitted if possible without incurring undue delay.</td><td> </td><td class="right">            being transmitted if possible without incurring undue delay.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0049" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">            <span class="delete">...</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Appendix F.  Timestamps Edge Cases</td><td> </td><td class="right">Appendix F.  Timestamps Edge Cases</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   While the rules laid out for when to calculate RTTM produce the</td><td> </td><td class="right">   While the rules laid out for when to calculate RTTM produce the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   correct results most of the time, there are some edge cases where an</td><td> </td><td class="right">   correct results most of the time, there are some edge cases where an</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   incorrect RTTM can be calculated.  All of these situations involve</td><td> </td><td class="right">   incorrect RTTM can be calculated.  All of these situations involve</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the loss of packets.  It is felt that these scenarios are rare, and</td><td> </td><td class="right">   the loss of packets.  It is felt that these scenarios are rare, and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   that if they should happen, they will cause a single RTTM measurement</td><td> </td><td class="right">   that if they should happen, they will cause a single RTTM measurement</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   to be inflated, which mitigates its effects on RTO calculations.</td><td> </td><td class="right">   to be inflated, which mitigates its effects on RTO calculations.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [Martin03] cites two similar cases when the returning ACK is lost,</td><td> </td><td class="right">   [Martin03] cites two similar cases when the returning ACK is lost,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   and before the retransmission timer fires, another returning packet</td><td> </td><td class="right">   and before the retransmission timer fires, another returning packet</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   arrives, which ACKs the data.  In this case, the RTTM calculated will</td><td> </td><td class="right">   arrives, which ACKs the data.  In this case, the RTTM calculated will</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   be inflated:</td><td> </td><td class="right">   be inflated:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0050" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">          clock</td><td> </td><td class="rblock">            clock</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">            tc=1   &lt;A, TSval=1&gt; -------------------&gt;</td><td> </td><td class="rblock">              tc=1   &lt;A, TSval=1&gt; -------------------&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0051" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">            tc=2   (lost) &lt;---- &lt;ACK(A), TSecr=1, win=n&gt;</td><td> </td><td class="rblock">              tc=2   (lost) &lt;---- &lt;ACK(A), TSecr=1, win=n&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                (RTTM would have been 1)</td><td> </td><td class="rblock">                  (RTTM would have been 1)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0052" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                   (receive window opens, window update is sent)</td><td> </td><td class="rblock">                     (receive window opens, window update is sent)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">            tc=5        &lt;---- &lt;ACK(A), TSecr=1, win=m&gt;</td><td> </td><td class="rblock">              tc=5        &lt;---- &lt;ACK(A), TSecr=1, win=m&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                   (RTTM is calculated at 4)</td><td> </td><td class="rblock">                     (RTTM is calculated at 4)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   One thing to note about this situation is that it is somewhat bounded</td><td> </td><td class="right">   One thing to note about this situation is that it is somewhat bounded</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   by RTO + RTT, limiting how far off the RTTM calculation will be.</td><td> </td><td class="right">   by RTO + RTT, limiting how far off the RTTM calculation will be.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   While more complex scenarios can be constructed that produce larger</td><td> </td><td class="right">   While more complex scenarios can be constructed that produce larger</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   inflations (e.g., retransmissions are lost), those scenarios involve</td><td> </td><td class="right">   inflations (e.g., retransmissions are lost), those scenarios involve</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   multiple packet losses, and the connection will have other more</td><td> </td><td class="right">   multiple packet losses, and the connection will have other more</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   serious operational problems than using an inflated RTTM in the RTO</td><td> </td><td class="right">   serious operational problems than using an inflated RTTM in the RTO</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   calculation.</td><td> </td><td class="right">   calculation.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Appendix G.  Changes from RFC 1072, RFC 1185, and RFC 1323</td><td> </td><td class="right">Appendix G.  Changes from RFC 1072, RFC 1185, and RFC 1323</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The protocol extensions defined in RFC 1323 document differ in</td><td> </td><td class="right">   The protocol extensions defined in RFC 1323 document differ in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   several important ways from those defined in RFC 1072 and RFC 1185.</td><td> </td><td class="right">   several important ways from those defined in RFC 1072 and RFC 1185.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (a)  SACK has been split off into a separate document, [RFC2018].</td><td> </td><td class="right">   (a)  SACK has been split off into a separate document, [RFC2018].</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0053" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   (b)  The detailed rules for sending timestamp replies (see</td><td> </td><td class="rblock">   (b)  The detailed rules for sending timestamp replies (see Section</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      Section 4.4) differ in important ways.  The earlier rules could</td><td> </td><td class="rblock">      4.4) differ in important ways.  The earlier rules could result in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      result in an under-estimate of the RTT in certain cases (packets</td><td> </td><td class="rblock">      an under-estimate of the RTT in certain cases (packets dropped or</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      dropped or out of order).</td><td> </td><td class="rblock">      out of order).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (c)  The same value TS.Recent is now shared by the two distinct</td><td> </td><td class="right">   (c)  The same value TS.Recent is now shared by the two distinct</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      mechanisms RTTM and PAWS.  This simplification became possible</td><td> </td><td class="right">      mechanisms RTTM and PAWS.  This simplification became possible</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      because of change (b).</td><td> </td><td class="right">      because of change (b).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (d)  An ambiguity in RFC 1185 was resolved in favor of putting</td><td> </td><td class="right">   (d)  An ambiguity in RFC 1185 was resolved in favor of putting</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      timestamps on ACK as well as data segments.  This supports the</td><td> </td><td class="right">      timestamps on ACK as well as data segments.  This supports the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      symmetry of the underlying TCP protocol.</td><td> </td><td class="right">      symmetry of the underlying TCP protocol.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (e)  The echo and echo reply options of RFC 1072 were combined into a</td><td> </td><td class="right">   (e)  The echo and echo reply options of RFC 1072 were combined into a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l12" /><small>skipping to change at</small><em> page 42, line 52</em></th><th> </th><th><a name="part-r12" /><small>skipping to change at</small><em> page 54, line 44</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      late timestamp negotiation.</td><td> </td><td class="right">      late timestamp negotiation.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (k)  Section 3.4 was added describing the unavoidable window</td><td> </td><td class="right">   (k)  Section 3.4 was added describing the unavoidable window</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      retraction issue, and explicitly describing the mitigation steps</td><td> </td><td class="right">      retraction issue, and explicitly describing the mitigation steps</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      necessary.</td><td> </td><td class="right">      necessary.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (l)  Section 2 was added for RFC2119 wording.  Normative text was</td><td> </td><td class="right">   (l)  Section 2 was added for RFC2119 wording.  Normative text was</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      updated with the appropriate phrases.</td><td> </td><td class="right">      updated with the appropriate phrases.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (m)  Removed much of the discussion in Section 1 to streamline the</td><td> </td><td class="right">   (m)  Removed much of the discussion in Section 1 to streamline the</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0054" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      document.  However, detailed examples and discussions in</td><td> </td><td class="rblock">      document.  However, detailed examples and discussions in Section</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      Section 3, Section 4 and Section 5 are kept as guideline for</td><td> </td><td class="rblock">      3, Section 4 and Section 5 are kept as guideline for implementers.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      implementers.</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (n)  Moved Appendix "Changes" at the end of the appendices for easier</td><td> </td><td class="right">   (n)  Moved Appendix "Changes" at the end of the appendices for easier</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      lookup.</td><td> </td><td class="right">      lookup.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Authors' Addresses</td><td> </td><td class="right">Authors' Addresses</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   David Borman</td><td> </td><td class="right">   David Borman</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Quantum Corporation</td><td> </td><td class="right">   Quantum Corporation</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Mendota Heights  MN 55120</td><td> </td><td class="right">   Mendota Heights  MN 55120</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   USA</td><td> </td><td class="right">   USA</td><td class="lineno" valign="top"></td></tr>

     <tr><td></td><td class="left"></td><td> </td><td class="right"></td><td></td></tr>
     <tr bgcolor="gray"><th colspan="5" align="center"><a name="end">&nbsp;End of changes. 54 change blocks.&nbsp;</a></th></tr>
     <tr class="stats"><td></td><th><i>165 lines changed or deleted</i></th><th><i> </i></th><th><i>84 lines changed or added</i></th><td></td></tr>
     <tr><td colspan="5" align="center" class="small"><br/>This html diff was produced by rfcdiff 1.41. The latest version is available from <a href="http://www.tools.ietf.org/tools/rfcdiff/" >http://tools.ietf.org/tools/rfcdiff/</a> </td></tr>
   </table>
   </body>
   </html>
