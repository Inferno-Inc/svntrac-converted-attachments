<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<!-- Generated by rfcdiff 1.41: rfcdiff  --> 
<!-- <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional" > -->
<!-- System: Linux rfcpa 2.6.27.45-0.1-xen #1 SMP 2010-02-22 16:49:47 +0100 x86_64 x86_64 x86_64 GNU/Linux --> 
<!-- Using awk: /usr/bin/gawk: GNU Awk 3.1.6 --> 
<!-- Using diff: /usr/bin/diff: diff (GNU diffutils) 2.8.7-cvs --> 
<!-- Using wdiff: /usr/bin/wdiff: GNU 0.5.2 L3 --> 
<html> 
<head> 
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /> 
  <meta http-equiv="Content-Style-Type" content="text/css" /> 
  <title>Diff: draft-ietf-tcpm-1323bis-05_v1output.txt - draft-ietf-tcpm-1323bis-05_v2output.txt</title> 
  <style type="text/css"> 
    body    { margin: 0.4ex; margin-right: auto; } 
    tr      { } 
    td      { white-space: pre; font-family: monospace; vertical-align: top; font-size: 0.86em;} 
    th      { font-size: 0.86em; } 
    .small  { font-size: 0.6em; font-style: italic; font-family: Verdana, Helvetica, sans-serif; } 
    .left   { background-color: #EEE; } 
    .right  { background-color: #FFF; } 
    .diff   { background-color: #CCF; } 
    .lblock { background-color: #BFB; } 
    .rblock { background-color: #FF8; } 
    .insert { background-color: #8FF; } 
    .delete { background-color: #ACF; } 
    .void   { background-color: #FFB; } 
    .cont   { background-color: #EEE; } 
    .linebr { background-color: #AAA; } 
    .lineno { color: red; background-color: #FFF; font-size: 0.7em; text-align: right; padding: 0 2px; } 
    .elipsis{ background-color: #AAA; } 
    .left .cont { background-color: #DDD; } 
    .right .cont { background-color: #EEE; } 
    .lblock .cont { background-color: #9D9; } 
    .rblock .cont { background-color: #DD6; } 
    .insert .cont { background-color: #0DD; } 
    .delete .cont { background-color: #8AD; } 
    .stats, .stats td, .stats th { background-color: #EEE; padding: 2px 0; } 
  </style> 
</head> 
<body > 
  <table border="0" cellpadding="0" cellspacing="0"> 
  <tr bgcolor="orange"><th></th><th>&nbsp;draft-ietf-tcpm-1323bis-05_v1output.txt&nbsp;</th><th> </th><th>&nbsp;draft-ietf-tcpm-1323bis-05_v2output.txt&nbsp;</th><th></th></tr> 
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">TCP Maintenance (TCPM)                                         D. Borman</td><td> </td><td class="right">TCP Maintenance (TCPM)                                         D. Borman</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Internet-Draft                                       Quantum Corporation</td><td> </td><td class="right">Internet-Draft                                       Quantum Corporation</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Intended status: Standards Track                               B. Braden</td><td> </td><td class="right">Intended status: Standards Track                               B. Braden</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0001" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">Expires: August 24, 2013                          University of Southern</td><td> </td><td class="rblock">Expires: August 24, 2013               University of Southern California</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                              California</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                             V. Jacobson</td><td> </td><td class="right">                                                             V. Jacobson</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                           Packet Design</td><td> </td><td class="right">                                                           Packet Design</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                   R. Scheffenegger, Ed.</td><td> </td><td class="right">                                                   R. Scheffenegger, Ed.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                            NetApp, Inc.</td><td> </td><td class="right">                                                            NetApp, Inc.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                       February 20, 2013</td><td> </td><td class="right">                                                       February 20, 2013</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                  TCP Extensions for High Performance</td><td> </td><td class="right">                  TCP Extensions for High Performance</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                       draft-ietf-tcpm-1323bis-05</td><td> </td><td class="right">                       draft-ietf-tcpm-1323bis-05</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Abstract</td><td> </td><td class="right">Abstract</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   This document specifies a set of TCP extensions to improve</td><td> </td><td class="right">   This document specifies a set of TCP extensions to improve</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   performance over paths with a large bandwidth*delay product and to</td><td> </td><td class="right">   performance over paths with a large bandwidth*delay product and to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   provide reliable operation over very high-speed paths.  It defines</td><td> </td><td class="right">   provide reliable operation over very high-speed paths.  It defines</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TCP options for scaled windows and timestamps.  The timestamps are</td><td> </td><td class="right">   TCP options for scaled windows and timestamps.  The timestamps are</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   used for two distinct mechanisms, RTTM (Round Trip Time Measurement)</td><td> </td><td class="right">   used for two distinct mechanisms, RTTM (Round Trip Time Measurement)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   and PAWS (Protection Against Wrapped Sequences).</td><td> </td><td class="right">   and PAWS (Protection Against Wrapped Sequences).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   This document updates and obsoletes RFC 1323.</td><td> </td><td class="right">   This document updates and obsoletes RFC 1323.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0002" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">Status of <span class="delete">t</span>his Memo</td><td> </td><td class="rblock">Status of <span class="insert">T</span>his Memo</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   This Internet-Draft is submitted in full conformance with the</td><td> </td><td class="right">   This Internet-Draft is submitted in full conformance with the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   provisions of BCP 78 and BCP 79.</td><td> </td><td class="right">   provisions of BCP 78 and BCP 79.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Internet-Drafts are working documents of the Internet Engineering</td><td> </td><td class="right">   Internet-Drafts are working documents of the Internet Engineering</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Task Force (IETF).  Note that other groups may also distribute</td><td> </td><td class="right">   Task Force (IETF).  Note that other groups may also distribute</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   working documents as Internet-Drafts.  The list of current Internet-</td><td> </td><td class="right">   working documents as Internet-Drafts.  The list of current Internet-</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Drafts is at http://datatracker.ietf.org/drafts/current/.</td><td> </td><td class="right">   Drafts is at http://datatracker.ietf.org/drafts/current/.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Internet-Drafts are draft documents valid for a maximum of six months</td><td> </td><td class="right">   Internet-Drafts are draft documents valid for a maximum of six months</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l2" /><small>skipping to change at</small><em> page 3, line 7</em></th><th> </th><th><a name="part-r2" /><small>skipping to change at</small><em> page 2, line 17</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (http://trustee.ietf.org/license-info) in effect on the date of</td><td> </td><td class="right">   (http://trustee.ietf.org/license-info) in effect on the date of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   publication of this document.  Please review these documents</td><td> </td><td class="right">   publication of this document.  Please review these documents</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   carefully, as they describe your rights and restrictions with respect</td><td> </td><td class="right">   carefully, as they describe your rights and restrictions with respect</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   to this document.  Code Components extracted from this document must</td><td> </td><td class="right">   to this document.  Code Components extracted from this document must</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   include Simplified BSD License text as described in Section 4.e of</td><td> </td><td class="right">   include Simplified BSD License text as described in Section 4.e of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the Trust Legal Provisions and are provided without warranty as</td><td> </td><td class="right">   the Trust Legal Provisions and are provided without warranty as</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   described in the Simplified BSD License.</td><td> </td><td class="right">   described in the Simplified BSD License.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Table of Contents</td><td> </td><td class="right">Table of Contents</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0003" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   1.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . <span class="delete">.  4</span></td><td> </td><td class="rblock">   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   <span class="insert">3</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     1.1.  TCP Performance  . . . . . . . . . . . . . . . . . . . . .  <span class="delete">4</span></td><td> </td><td class="rblock">     1.1.  TCP Performance . . . . . . . . . . . . . . . . . . . . .   <span class="insert">3</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     1.2.  TCP Reliability  . . . . . . . . . . . . . . . . . . . . .  <span class="delete">5</span></td><td> </td><td class="rblock">     1.2.  TCP Reliability . . . . . . . . . . . . . . . . . . . . .   <span class="insert">4</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     1.3.  Using TCP options  . . . . . . . . . . . . . . . . . . . .  <span class="delete">6</span></td><td> </td><td class="rblock">     1.3.  Using TCP options . . . . . . . . . . . . . . . . . . . .   <span class="insert">5</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   2.  Terminology  . . . . . . . . . . . . . . . . . . . . . . . . .  <span class="delete">7</span></td><td> </td><td class="rblock">   2.  Terminology . . . . . . . . . . . . . . . . . . . . . . . . .   <span class="insert">6</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   3.  TCP Window Scale Option  . . . . . . . . . . . . . . . . . . .  <span class="delete">7</span></td><td> </td><td class="rblock">   3.  TCP Window Scale Option . . . . . . . . . . . . . . . . . . .   <span class="insert">6</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     3.1.  Introduction . . . . . . . . . . . . . . . . . . . . . . <span class="delete">.  7</span></td><td> </td><td class="rblock">     3.1.  Introduction  . . . . . . . . . . . . . . . . . . . . . .   <span class="insert">6</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     3.2.  Window Scale Option  . . . . . . . . . . . . . . . . . . .  <span class="delete">7</span></td><td> </td><td class="rblock">     3.2.  Window Scale Option . . . . . . . . . . . . . . . . . . .   <span class="insert">6</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     3.3.  Using the Window Scale Option  . . . . . . . . . . . . . .  <span class="delete">8</span></td><td> </td><td class="rblock">     3.3.  Using the Window Scale Option . . . . . . . . . . . . . .   <span class="insert">7</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     3.4.  Addressing Window Retraction . . . . . . . . . . . . . . <span class="delete">. 10</span></td><td> </td><td class="rblock">     3.4.  Addressing Window Retraction  . . . . . . . . . . . . . .   <span class="insert">9</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   4.  RTTM -- Round-Trip Time Measurement  . . . . . . . . . . . . . 11</td><td> </td><td class="rblock">   4.  RTTM -- Round-Trip Time Measurement . . . . . . . . . . . . .  11</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     4.1.  Introduction . . . . . . . . . . . . . . . . . . . . . . <span class="delete">.</span> 11</td><td> </td><td class="rblock">     4.1.  Introduction  . . . . . . . . . . . . . . . . . . . . . .  11</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     4.2.  TCP Timestamps Option  . . . . . . . . . . . . . . . . . . 12</td><td> </td><td class="rblock">     4.2.  TCP Timestamps Option . . . . . . . . . . . . . . . . . .  12</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     4.3.  The RTTM Mechanism . . . . . . . . . . . . . . . . . . . <span class="delete">.</span> 13</td><td> </td><td class="rblock">     4.3.  The RTTM Mechanism  . . . . . . . . . . . . . . . . . . .  13</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     4.4.  Which Timestamp to Echo  . . . . . . . . . . . . . . . . . 14</td><td> </td><td class="rblock">     4.4.  Which Timestamp to Echo . . . . . . . . . . . . . . . . .  14</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   5.  PAWS -- Protection Against Wrapped Sequence Numbers  . . . . . 17</td><td> </td><td class="rblock">   5.  PAWS -- Protection Against Wrapped Sequence Numbers . . . . .  17</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     5.1.  Introduction . . . . . . . . . . . . . . . . . . . . . . <span class="delete">.</span> 17</td><td> </td><td class="rblock">     5.1.  Introduction  . . . . . . . . . . . . . . . . . . . . . .  17</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     5.2.  The PAWS Mechanism . . . . . . . . . . . . . . . . . . . <span class="delete">.</span> 17</td><td> </td><td class="rblock">     5.2.  The PAWS Mechanism  . . . . . . . . . . . . . . . . . . .  17</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       5.2.1.  Basic PAWS Algorithm . . . . . . . . . . . . . . . . <span class="delete">.</span> 18</td><td> </td><td class="rblock">       5.2.1.  Basic PAWS Algorithm  . . . . . . . . . . . . . . . .  18</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       5.2.2.  Timestamp Clock  . . . . . . . . . . . . . . . . . . . 20</td><td> </td><td class="rblock">       5.2.2.  Timestamp Clock . . . . . . . . . . . . . . . . . . .  20</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       5.2.3.  Outdated Timestamps  . . . . . . . . . . . . . . . . . 22</td><td> </td><td class="rblock">       5.2.3.  Outdated Timestamps . . . . . . . . . . . . . . . . .  22</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       5.2.4.  Header Prediction  . . . . . . . . . . . . . . . . . . 22</td><td> </td><td class="rblock">       5.2.4.  Header Prediction . . . . . . . . . . . . . . . . . .  22</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       5.2.5.  IP Fragmentation . . . . . . . . . . . . . . . . . . <span class="delete">.</span> 24</td><td> </td><td class="rblock">       5.2.5.  IP Fragmentation  . . . . . . . . . . . . . . . . . .  24</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     5.3.  Duplicates from Earlier Incarnations of Connection . . . <span class="delete">.</span> 24</td><td> </td><td class="rblock">     5.3.  Duplicates from Earlier Incarnations of Connection  . . .  24</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   6.  Conclusions and Acknowledgements . . . . . . . . . . . . . . <span class="delete">. 24</span></td><td> </td><td class="rblock">   6.  Conclusions and Acknowledgements  . . . . . . . . . . . . . .  <span class="insert">25</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   7.  Security Considerations  . . . . . . . . . . . . . . . . . . . 25</td><td> </td><td class="rblock">   7.  Security Considerations . . . . . . . . . . . . . . . . . . .  25</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   8.  IANA Considerations  . . . . . . . . . . . . . . . . . . . . . 26</td><td> </td><td class="rblock">   8.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .  26</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   9.  References . . . . . . . . . . . . . . . . . . . . . . . . . <span class="delete">.</span> 26</td><td> </td><td class="rblock">   9.  References  . . . . . . . . . . . . . . . . . . . . . . . . .  26</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     9.1.  Normative References . . . . . . . . . . . . . . . . . . <span class="delete">.</span> 26</td><td> </td><td class="rblock">     9.1.  Normative References  . . . . . . . . . . . . . . . . . .  26</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     9.2.  Informative References . . . . . . . . . . . . . . . . . <span class="delete">.</span> 26</td><td> </td><td class="rblock">     9.2.  Informative References  . . . . . . . . . . . . . . . . .  26</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Appendix A.  Implementation Suggestions  . . . . . . . . . . . . . 28</td><td> </td><td class="rblock">   Appendix A.  Implementation Suggestions . . . . . . . . . . . . .  28</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Appendix B.  Duplicates from Earlier Connection Incarnations . . <span class="delete">.</span> 29</td><td> </td><td class="rblock">   Appendix B.  Duplicates from Earlier Connection Incarnations  . .  29</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     B.1.  System Crash with Loss of State  . . . . . . . . . . . . . 29</td><td> </td><td class="rblock">     B.1.  System Crash with Loss of State . . . . . . . . . . . . .  29</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     B.2.  Closing and Reopening a Connection . . . . . . . . . . . <span class="delete">.</span> 30</td><td> </td><td class="rblock">     B.2.  Closing and Reopening a Connection  . . . . . . . . . . .  30</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Appendix C.  Summary of Notation . . . . . . . . . . . . . . . . <span class="delete">.</span> 31</td><td> </td><td class="rblock">   Appendix C.  Summary of Notation  . . . . . . . . . . . . . . . .  31</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Appendix D.  Pseudo-code Summary . . . . . . . . . . . . . . . . <span class="delete">.</span> 32</td><td> </td><td class="rblock">   Appendix D.  Pseudo-code Summary  . . . . . . . . . . . . . . . .  32</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Appendix E.  Event Processing Summary  . . . . . . . . . . . . . . 34</td><td> </td><td class="rblock">   Appendix E.  Event Processing Summary . . . . . . . . . . . . . .  34</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Appendix F.  Timestamps Edge Cases . . . . . . . . . . . . . . . <span class="delete">. 39</span></td><td> </td><td class="rblock">   Appendix F.  Timestamps Edge Cases  . . . . . . . . . . . . . . .  <span class="insert">40</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Appendix G.  Changes from RFC 1072, RFC 1185, and RFC 1323 . . . <span class="delete">.</span> 40</td><td> </td><td class="rblock">   Appendix G.  Changes from RFC 1072, RFC 1185, and RFC 1323  . . .  40</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Authors' Addresses . . . . . . . . . . . . . . . . . . . . . . . <span class="delete">. 42</span></td><td> </td><td class="rblock">   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  <span class="insert">43</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">1.  Introduction</td><td> </td><td class="right">1.  Introduction</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The TCP protocol [RFC0793] was designed to operate reliably over</td><td> </td><td class="right">   The TCP protocol [RFC0793] was designed to operate reliably over</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   almost any transmission medium regardless of transmission rate,</td><td> </td><td class="right">   almost any transmission medium regardless of transmission rate,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   delay, corruption, duplication, or reordering of segments.  Over the</td><td> </td><td class="right">   delay, corruption, duplication, or reordering of segments.  Over the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   years, advances in networking technology has resulted in ever-higher</td><td> </td><td class="right">   years, advances in networking technology has resulted in ever-higher</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   transmission speeds, and the fastest paths are well beyond the domain</td><td> </td><td class="right">   transmission speeds, and the fastest paths are well beyond the domain</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   for which TCP was originally engineered.</td><td> </td><td class="right">   for which TCP was originally engineered.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l3" /><small>skipping to change at</small><em> page 4, line 35</em></th><th> </th><th><a name="part-r3" /><small>skipping to change at</small><em> page 3, line 39</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">1.1.  TCP Performance</td><td> </td><td class="right">1.1.  TCP Performance</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TCP performance problems arise when the bandwidth*delay product is</td><td> </td><td class="right">   TCP performance problems arise when the bandwidth*delay product is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   large.</td><td> </td><td class="right">   large.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   There are three fundamental performance problems with the current TCP</td><td> </td><td class="right">   There are three fundamental performance problems with the current TCP</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   over LFN paths:</td><td> </td><td class="right">   over LFN paths:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (1)  Window Size Limit</td><td> </td><td class="right">   (1)  Window Size Limit</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0004" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        The TCP header uses a 16 bit field to report the receive window</td><td> </td><td class="rblock">      The TCP header uses a 16 bit field to report the receive window</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        size to the sender.  Therefore, the largest window that can be</td><td> </td><td class="rblock">      size to the sender.  Therefore, the largest window that can be</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        used is 2^16 = 65K bytes.</td><td> </td><td class="rblock">      used is 2^16 = 65K bytes.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0005" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        To circumvent this problem, Section 2 of this memo defines a new</td><td> </td><td class="rblock">      To circumvent this problem, Section 2 of this memo defines a new</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        TCP option, "Window Scale", to allow windows larger than 2^16.</td><td> </td><td class="rblock">      TCP option, "Window Scale", to allow windows larger than 2^16.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        This option defines an implicit scale factor, which is used to</td><td> </td><td class="rblock">      This option defines an implicit scale factor, which is used to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        multiply the window size value found in a TCP header to obtain</td><td> </td><td class="rblock">      multiply the window size value found in a TCP header to obtain the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        the true window size.</td><td> </td><td class="rblock">      true window size.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (2)  Recovery from Losses</td><td> </td><td class="right">   (2)  Recovery from Losses</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0006" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">      <span class="insert">Packet losses in an LFN can have a catastrophic effect on</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      throughput.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0007" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        <span class="delete">Packet losses in an LFN can have a catastrophic effect on</span></td><td> </td><td class="rblock">      To generalize the Fast Retransmit/Fast Recovery mechanism to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">        throughput.</span></td><td> </td><td class="rblock">      handle multiple packets dropped per window, selective</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock">      acknowledgments are required.  Unlike the normal cumulative</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        To generalize the Fast Retransmit/Fast Recovery mechanism to</td><td> </td><td class="rblock">      acknowledgments of TCP, selective acknowledgments give the sender</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        handle multiple packets dropped per window, selective</td><td> </td><td class="rblock">      a complete picture of which segments are queued at the receiver</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        acknowledgments are required.  Unlike the normal cumulative</td><td> </td><td class="rblock">      and which have not yet arrived.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        acknowledgments of TCP, selective acknowledgments give the</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        sender a complete picture of which segments are queued at the</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        receiver and which have not yet arrived.</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0008" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        Selective acknowledgements are specified in a separate document,</td><td> </td><td class="rblock">      Selective acknowledgements are specified in a separate document,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        "A Conservative Selective Acknowledgment (SACK)-based Loss</td><td> </td><td class="rblock">      "A Conservative Selective Acknowledgment (SACK)-based Loss</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        Recovery Algorithm for TCP" [RFC6675], and not further discussed</td><td> </td><td class="rblock">      Recovery Algorithm for TCP" [RFC6675], and not further discussed</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        in this document.</td><td> </td><td class="rblock">      in this document.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (3)  Round-Trip Measurement</td><td> </td><td class="right">   (3)  Round-Trip Measurement</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0009" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        TCP implements reliable data delivery by retransmitting segments</td><td> </td><td class="rblock">      TCP implements reliable data delivery by retransmitting segments</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        that are not acknowledged within some retransmission timeout</td><td> </td><td class="rblock">      that are not acknowledged within some retransmission timeout (RTO)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        (RTO) interval.  Accurate dynamic determination of an</td><td> </td><td class="rblock">      interval.  Accurate dynamic determination of an appropriate RTO is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        appropriate RTO is essential to TCP performance.  RTO is</td><td> </td><td class="rblock">      essential to TCP performance.  RTO is determined by estimating the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        determined by estimating the mean and variance of the measured</td><td> </td><td class="rblock">      mean and variance of the measured round-trip time (RTT), i.e., the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        round-trip time (RTT), i.e., the time interval between sending a</td><td> </td><td class="rblock">      time interval between sending a segment and receiving an</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        segment and receiving an acknowledgment for it [Jacobson88a].</td><td> </td><td class="rblock">      acknowledgment for it [Jacobson88a].</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0010" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        Section 4.2 introduces a new TCP option, "Timestamps", and then</td><td> </td><td class="rblock">      Section 4.2 introduces a new TCP option, "Timestamps", and then</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        defines a mechanism using this option that allows nearly every</td><td> </td><td class="rblock">      defines a mechanism using this option that allows nearly every</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        segment, including retransmissions, to be timed at negligible</td><td> </td><td class="rblock">      segment, including retransmissions, to be timed at negligible</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        computational cost.  We use the mnemonic RTTM (Round Trip Time</td><td> </td><td class="rblock">      computational cost.  We use the mnemonic RTTM (Round Trip Time</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        Measurement) for this mechanism, to distinguish it from other</td><td> </td><td class="rblock">      Measurement) for this mechanism, to distinguish it from other uses</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        uses of the Timestamps option.</td><td> </td><td class="rblock">      of the Timestamps option.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">1.2.  TCP Reliability</td><td> </td><td class="right">1.2.  TCP Reliability</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   An especially serious kind of error may result from an accidental</td><td> </td><td class="right">   An especially serious kind of error may result from an accidental</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   reuse of TCP sequence numbers in data segments.  TCP reliability</td><td> </td><td class="right">   reuse of TCP sequence numbers in data segments.  TCP reliability</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   depends upon the existence of a bound on the lifetime of a segment:</td><td> </td><td class="right">   depends upon the existence of a bound on the lifetime of a segment:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the "Maximum Segment Lifetime" or MSL.</td><td> </td><td class="right">   the "Maximum Segment Lifetime" or MSL.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Duplication of sequence numbers might happen in either of two ways:</td><td> </td><td class="right">   Duplication of sequence numbers might happen in either of two ways:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (1)  Sequence number wrap-around on the current connection</td><td> </td><td class="right">   (1)  Sequence number wrap-around on the current connection</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0011" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        A TCP sequence number contains 32 bits.  At a high enough</td><td> </td><td class="rblock">      A TCP sequence number contains 32 bits.  At a high enough transfer</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        transfer rate, the 32-bit sequence space may be "wrapped"</td><td> </td><td class="rblock">      rate, the 32-bit sequence space may be "wrapped" (cycled) within</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        (cycled) within the time that a segment is delayed in queues.</td><td> </td><td class="rblock">      the time that a segment is delayed in queues.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (2)  Earlier incarnation of the connection</td><td> </td><td class="right">   (2)  Earlier incarnation of the connection</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0012" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock">      Suppose that a connection terminates, either by a proper close</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        Suppose that a connection terminates, either by a proper close</td><td> </td><td class="rblock">      sequence or due to a host crash, and the same connection (i.e.,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        sequence or due to a host crash, and the same connection (i.e.,</td><td> </td><td class="rblock">      using the same pair of port numbers) is immediately reopened.  A</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        using the same pair of port numbers) is immediately reopened.  A</td><td> </td><td class="rblock">      delayed segment from the terminated connection could fall within</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        delayed segment from the terminated connection could fall within</td><td> </td><td class="rblock">      the current window for the new incarnation and be accepted as</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        the current window for the new incarnation and be accepted as</td><td> </td><td class="rblock">      valid.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        valid.</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Duplicates from earlier incarnations, Case (2), are avoided by</td><td> </td><td class="right">   Duplicates from earlier incarnations, Case (2), are avoided by</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   enforcing the current fixed MSL of the TCP spec, as explained in</td><td> </td><td class="right">   enforcing the current fixed MSL of the TCP spec, as explained in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Section 5.3 and Appendix B.  However, case (1), avoiding the reuse of</td><td> </td><td class="right">   Section 5.3 and Appendix B.  However, case (1), avoiding the reuse of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   sequence numbers within the same connection, requires an MSL bound</td><td> </td><td class="right">   sequence numbers within the same connection, requires an MSL bound</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   that depends upon the transfer rate, and at high enough rates, a new</td><td> </td><td class="right">   that depends upon the transfer rate, and at high enough rates, a new</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   mechanism is required.</td><td> </td><td class="right">   mechanism is required.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   A possible fix for the problem of cycling the sequence space would be</td><td> </td><td class="right">   A possible fix for the problem of cycling the sequence space would be</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   to increase the size of the TCP sequence number field.  For example,</td><td> </td><td class="right">   to increase the size of the TCP sequence number field.  For example,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l4" /><small>skipping to change at</small><em> page 10, line 21</em></th><th> </th><th><a name="part-r4" /><small>skipping to change at</small><em> page 9, line 36</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   bytes smaller than that granularity, the TCP will have to either</td><td> </td><td class="right">   bytes smaller than that granularity, the TCP will have to either</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   advertise a new window that is beyond what it previously advertised</td><td> </td><td class="right">   advertise a new window that is beyond what it previously advertised</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (and perhaps beyond the buffer), or will have to advertise a smaller</td><td> </td><td class="right">   (and perhaps beyond the buffer), or will have to advertise a smaller</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   window, which will cause the TCP window to shrink.  Implementations</td><td> </td><td class="right">   window, which will cause the TCP window to shrink.  Implementations</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   MUST ensure that they handle a shrinking window, as specified in</td><td> </td><td class="right">   MUST ensure that they handle a shrinking window, as specified in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   section 4.2.2.16 of [RFC1122].</td><td> </td><td class="right">   section 4.2.2.16 of [RFC1122].</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   For the receiver, this implies that:</td><td> </td><td class="right">   For the receiver, this implies that:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   1)  The receiver MUST honor, as in-window, any segment that would</td><td> </td><td class="right">   1)  The receiver MUST honor, as in-window, any segment that would</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0013" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      <span class="delete"> </span>have been in-window for any ACK sent by the receiver.</td><td> </td><td class="rblock">      have been in-window for any ACK sent by the receiver.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   2)  When window scaling is in effect, the receiver SHOULD track the</td><td> </td><td class="right">   2)  When window scaling is in effect, the receiver SHOULD track the</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0014" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       actual maximum window sequence number (which is likely to be</td><td> </td><td class="rblock">      actual maximum window sequence number (which is likely to be</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       greater than the window announced by the most recent ACK, if more</td><td> </td><td class="rblock">      greater than the window announced by the most recent ACK, if more</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       than one segment has arrived since the application consumed any</td><td> </td><td class="rblock">      than one segment has arrived since the application consumed any</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       data in the receive buffer).</td><td> </td><td class="rblock">      data in the receive buffer).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   On the sender side:</td><td> </td><td class="right">   On the sender side:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   3)  The initial transmission MUST honor window on most recent ACK.</td><td> </td><td class="right">   3)  The initial transmission MUST honor window on most recent ACK.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   4)  On first retransmission, or if the sequence number is out-of-</td><td> </td><td class="right">   4)  On first retransmission, or if the sequence number is out-of-</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0015" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       window by less than (2^Rcv.Wind.Scale) then do normal</td><td> </td><td class="rblock">      window by less than (2^Rcv.Wind.Scale) then do normal</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       retransmission(s) without regard to receiver window as long as</td><td> </td><td class="rblock">      retransmission(s) without regard to receiver window as long as the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       the original segment was in window when it was sent.</td><td> </td><td class="rblock">      original segment was in window when it was sent.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   5)  On subsequent retransmissions, treat such ACKs as zero window</td><td> </td><td class="right">   5)  On subsequent retransmissions, treat such ACKs as zero window</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0016" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      <span class="delete"> </span>probes.</td><td> </td><td class="rblock">      probes.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">4.  RTTM -- Round-Trip Time Measurement</td><td> </td><td class="right">4.  RTTM -- Round-Trip Time Measurement</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">4.1.  Introduction</td><td> </td><td class="right">4.1.  Introduction</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Accurate and current RTT estimates are necessary to adapt to changing</td><td> </td><td class="right">   Accurate and current RTT estimates are necessary to adapt to changing</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   traffic conditions and to avoid an instability known as "congestion</td><td> </td><td class="right">   traffic conditions and to avoid an instability known as "congestion</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   collapse" [RFC0896] in a busy network.  However, accurate measurement</td><td> </td><td class="right">   collapse" [RFC0896] in a busy network.  However, accurate measurement</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   of RTT may be difficult both in theory and in implementation.</td><td> </td><td class="right">   of RTT may be difficult both in theory and in implementation.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l5" /><small>skipping to change at</small><em> page 13, line 21</em></th><th> </th><th><a name="part-r5" /><small>skipping to change at</small><em> page 13, line 25</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   These TSval values are echoed in TSecr values in the reverse</td><td> </td><td class="right">   These TSval values are echoed in TSecr values in the reverse</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   direction.  The difference between a received TSecr value and the</td><td> </td><td class="right">   direction.  The difference between a received TSecr value and the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   current timestamp clock value provides a RTT measurement.</td><td> </td><td class="right">   current timestamp clock value provides a RTT measurement.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   When timestamps are used, every segment that is received will contain</td><td> </td><td class="right">   When timestamps are used, every segment that is received will contain</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   a TSecr value.  However, these values cannot all be used to update</td><td> </td><td class="right">   a TSecr value.  However, these values cannot all be used to update</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the measured RTT.  The following example illustrates why.  It shows a</td><td> </td><td class="right">   the measured RTT.  The following example illustrates why.  It shows a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   one-way data flow with segments arriving in sequence without loss.</td><td> </td><td class="right">   one-way data flow with segments arriving in sequence without loss.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Here A, B, C... represent data blocks occupying successive blocks of</td><td> </td><td class="right">   Here A, B, C... represent data blocks occupying successive blocks of</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0017" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   sequence numbers, and ACK(A),... represent the corresponding</td><td> </td><td class="rblock">   sequence numbers, and ACK(A),... <span class="insert"> </span>represent the corresponding</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   cumulative acknowledgments.  The two timestamp fields of the</td><td> </td><td class="right">   cumulative acknowledgments.  The two timestamp fields of the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Timestamps option are shown symbolically as &lt;TSval=x,TSecr=y&gt;.  Each</td><td> </td><td class="right">   Timestamps option are shown symbolically as &lt;TSval=x,TSecr=y&gt;.  Each</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TSecr field contains the value most recently received in a TSval</td><td> </td><td class="right">   TSecr field contains the value most recently received in a TSval</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   field.</td><td> </td><td class="right">   field.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0018" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">             <span class="delete"> </span>TCP  A                                     TCP B</td><td> </td><td class="rblock">             TCP  A                                     TCP B</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0019" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                             <span class="delete"> </span>&lt;A,TSval=1,TSecr=120&gt; -----&gt;</td><td> </td><td class="rblock">                             &lt;A,TSval=1,TSecr=120&gt; -----&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0020" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                  <span class="delete"> </span>&lt;---- &lt;ACK(A),TSval=127,TSecr=1&gt;</td><td> </td><td class="rblock">                  &lt;---- &lt;ACK(A),TSval=127,TSecr=1&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0021" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                             <span class="delete"> </span>&lt;B,TSval=5,TSecr=127&gt; -----&gt;</td><td> </td><td class="rblock">                             &lt;B,TSval=5,TSecr=127&gt; -----&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0022" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                  <span class="delete"> </span>&lt;---- &lt;ACK(B),TSval=131,TSecr=5&gt;</td><td> </td><td class="rblock">                  &lt;---- &lt;ACK(B),TSval=131,TSecr=5&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0023" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               <span class="delete"> </span>. . . . . . . . . . . . . . . . . . . . . .</td><td> </td><td class="rblock">               . . . . . . . . . . . . . . . . . . . . . .</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0024" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                             <span class="delete"> </span>&lt;C,TSval=65,TSecr=131&gt; ----&gt;</td><td> </td><td class="rblock">                             &lt;C,TSval=65,TSecr=131&gt; ----&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0025" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                  <span class="delete"> </span>&lt;---- &lt;ACK(C),TSval=191,TSecr=65&gt;</td><td> </td><td class="rblock">                  &lt;---- &lt;ACK(C),TSval=191,TSecr=65&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0026" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                 <span class="delete"> </span>(etc.)</td><td> </td><td class="rblock">                                 (etc.)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The dotted line marks a pause (60 time units long) in which A had</td><td> </td><td class="right">   The dotted line marks a pause (60 time units long) in which A had</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   nothing to send.  Note that this pause inflates the RTT which B could</td><td> </td><td class="right">   nothing to send.  Note that this pause inflates the RTT which B could</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0027" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   infer from receiving TSecr=131 in data segment C. Thus, in one-way</td><td> </td><td class="rblock">   infer from receiving TSecr=131 in data segment C. <span class="insert"> </span>Thus, in one-way</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   data flows, RTTM in the reverse direction measures a value that is</td><td> </td><td class="right">   data flows, RTTM in the reverse direction measures a value that is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   inflated by gaps in sending data.  However, the following rule</td><td> </td><td class="right">   inflated by gaps in sending data.  However, the following rule</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   prevents a resulting inflation of the measured RTT:</td><td> </td><td class="right">   prevents a resulting inflation of the measured RTT:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      RTTM Rule: A TSecr value received in a segment is used to update</td><td> </td><td class="right">      RTTM Rule: A TSecr value received in a segment is used to update</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      the averaged RTT measurement only if</td><td> </td><td class="right">      the averaged RTT measurement only if</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      a)  the segment acknowledges some new data, i.e., only if it</td><td> </td><td class="right">      a)  the segment acknowledges some new data, i.e., only if it</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0028" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">          advances the left edge of the send window, and</td><td> </td><td class="rblock">          <span class="insert">  </span>advances the left edge of the send window, and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      b)  the segment does not indicate any loss or reordering, i.e.</td><td> </td><td class="right">      b)  the segment does not indicate any loss or reordering, i.e.</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0029" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">          contains SACK options</td><td> </td><td class="rblock">          <span class="insert">  </span>contains SACK options</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Since TCP B is not sending data, the data segment C does not</td><td> </td><td class="right">   Since TCP B is not sending data, the data segment C does not</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0030" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   acknowledge any new data when it arrives at B. Thus, the inflated</td><td> </td><td class="rblock">   acknowledge any new data when it arrives at B. <span class="insert"> </span>Thus, the inflated</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   RTTM measurement is not used to update B's RTTM measurement.</td><td> </td><td class="right">   RTTM measurement is not used to update B's RTTM measurement.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Implementers should note that with Timestamps multiple RTTMs can be</td><td> </td><td class="right">   Implementers should note that with Timestamps multiple RTTMs can be</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   taken per RTT.  Many RTO estimators have a weighting factor based on</td><td> </td><td class="right">   taken per RTT.  Many RTO estimators have a weighting factor based on</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   an implicit assumption that at most one RTTM will be sampled per RTT.</td><td> </td><td class="right">   an implicit assumption that at most one RTTM will be sampled per RTT.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   When using multiple RTTMs per RTT to update the RTO estimator, the</td><td> </td><td class="right">   When using multiple RTTMs per RTT to update the RTO estimator, the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   weighting factor needs to be decreased to take into account the more</td><td> </td><td class="right">   weighting factor needs to be decreased to take into account the more</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   frequent RTTMs.  For example, an implementation could choose to just</td><td> </td><td class="right">   frequent RTTMs.  For example, an implementation could choose to just</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   use one sample per RTT to update the RTO estimator, or vary the gain</td><td> </td><td class="right">   use one sample per RTT to update the RTO estimator, or vary the gain</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   based on the congestion window, or take an average of all the RTTM</td><td> </td><td class="right">   based on the congestion window, or take an average of all the RTTM</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l6" /><small>skipping to change at</small><em> page 14, line 42</em></th><th> </th><th><a name="part-r6" /><small>skipping to change at</small><em> page 14, line 45</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   If more than one Timestamps option is received before a reply segment</td><td> </td><td class="right">   If more than one Timestamps option is received before a reply segment</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   is sent, the TCP must choose only one of the TSvals to echo, ignoring</td><td> </td><td class="right">   is sent, the TCP must choose only one of the TSvals to echo, ignoring</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the others.  To minimize the state kept in the receiver (i.e., the</td><td> </td><td class="right">   the others.  To minimize the state kept in the receiver (i.e., the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   number of unprocessed TSvals), the receiver should be required to</td><td> </td><td class="right">   number of unprocessed TSvals), the receiver should be required to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   retain at most one timestamp in the connection control block.</td><td> </td><td class="right">   retain at most one timestamp in the connection control block.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   There are three situations to consider:</td><td> </td><td class="right">   There are three situations to consider:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (A)  Delayed ACKs.</td><td> </td><td class="right">   (A)  Delayed ACKs.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0031" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        Many TCP's acknowledge only every Kth segment out of a group of</td><td> </td><td class="rblock">      Many TCP's acknowledge only every Kth segment out of a group of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        segments arriving within a short time interval; this policy is</td><td> </td><td class="rblock">      segments arriving within a short time interval; this policy is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        known generally as "delayed ACKs".  The data-sender TCP must</td><td> </td><td class="rblock">      known generally as "delayed ACKs".  The data-sender TCP must</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        measure the effective RTT, including the additional time due to</td><td> </td><td class="rblock">      measure the effective RTT, including the additional time due to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        delayed ACKs, or else it will retransmit unnecessarily.  Thus,</td><td> </td><td class="rblock">      delayed ACKs, or else it will retransmit unnecessarily.  Thus,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        when delayed ACKs are in use, the receiver SHOULD reply with the</td><td> </td><td class="rblock">      when delayed ACKs are in use, the receiver SHOULD reply with the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        TSval field from the earliest unacknowledged segment.</td><td> </td><td class="rblock">      TSval field from the earliest unacknowledged segment.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (B)  A hole in the sequence space (segment(s) have been lost).</td><td> </td><td class="right">   (B)  A hole in the sequence space (segment(s) have been lost).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0032" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        The sender will continue sending until the window is filled, and</td><td> </td><td class="rblock">      The sender will continue sending until the window is filled, and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        the receiver may be generating ACKs as these out-of-order</td><td> </td><td class="rblock">      the receiver may be generating ACKs as these out-of-order segments</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        segments arrive (e.g., to aid "fast retransmit").</td><td> </td><td class="rblock">      arrive (e.g., to aid "fast retransmit").</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0033" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        The lost segment is probably a sign of congestion, and in that</td><td> </td><td class="rblock">      The lost segment is probably a sign of congestion, and in that</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        situation the sender should be conservative about</td><td> </td><td class="rblock">      situation the sender should be conservative about retransmission.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        retransmission.  Furthermore, it is better to overestimate than</td><td> </td><td class="rblock">      Furthermore, it is better to overestimate than underestimate the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        underestimate the RTT.  An ACK for an out-of-order segment</td><td> </td><td class="rblock">      RTT.  An ACK for an out-of-order segment SHOULD therefore contain</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        SHOULD therefore contain the timestamp from the most recent</td><td> </td><td class="rblock">      the timestamp from the most recent segment that advanced the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        segment that advanced the window.</td><td> </td><td class="rblock">      window.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0034" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        The same situation occurs if segments are re-ordered by the</td><td> </td><td class="rblock">      The same situation occurs if segments are re-ordered by the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        network.</td><td> </td><td class="rblock">      network.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (C)  A filled hole in the sequence space.</td><td> </td><td class="right">   (C)  A filled hole in the sequence space.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0035" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        The segment that fills the hole represents the most recent</td><td> </td><td class="rblock">      The segment that fills the hole represents the most recent</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        measurement of the network characteristics.  On the other hand,</td><td> </td><td class="rblock">      measurement of the network characteristics.  On the other hand, an</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        an RTT computed from an earlier segment would probably include</td><td> </td><td class="rblock">      RTT computed from an earlier segment would probably include the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        the sender's retransmit time-out, badly biasing the sender's</td><td> </td><td class="rblock">      sender's retransmit time-out, badly biasing the sender's average</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        average RTT estimate.  Thus, the timestamp from the latest</td><td> </td><td class="rblock">      RTT estimate.  Thus, the timestamp from the latest segment (which</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        segment (which filled the hole) MUST be echoed.</td><td> </td><td class="rblock">      filled the hole) MUST be echoed.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   An algorithm that covers all three cases is described in the</td><td> </td><td class="right">   An algorithm that covers all three cases is described in the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   following rules for Timestamps option processing on a synchronized</td><td> </td><td class="right">   following rules for Timestamps option processing on a synchronized</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   connection:</td><td> </td><td class="right">   connection:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (1)  The connection state is augmented with two 32-bit slots:</td><td> </td><td class="right">   (1)  The connection state is augmented with two 32-bit slots:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0036" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        TS.Recent holds a timestamp to be echoed in TSecr whenever a</td><td> </td><td class="rblock">      TS.Recent holds a timestamp to be echoed in TSecr whenever a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        segment is sent, and Last.ACK.sent holds the ACK field from the</td><td> </td><td class="rblock">      segment is sent, and Last.ACK.sent holds the ACK field from the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        last segment sent.  Last.ACK.sent will equal RCV.NXT except when</td><td> </td><td class="rblock">      last segment sent.  Last.ACK.sent will equal RCV.NXT except when</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        ACKs have been delayed.</td><td> </td><td class="rblock">      ACKs have been delayed.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (2)  If:</td><td> </td><td class="right">   (2)  If:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            SEG.TSval &gt;= TS.recent and SEG.SEQ &lt;= Last.ACK.sent</td><td> </td><td class="right">            SEG.TSval &gt;= TS.recent and SEG.SEQ &lt;= Last.ACK.sent</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0037" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      <span class="delete">  </span>then SEG.TSval is copied to TS.Recent; otherwise, it is ignored.</td><td> </td><td class="rblock">      then SEG.TSval is copied to TS.Recent; otherwise, it is ignored.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (3)  When a TSopt is sent, its TSecr field is set to the current</td><td> </td><td class="right">   (3)  When a TSopt is sent, its TSecr field is set to the current</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0038" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      <span class="delete">  </span>TS.Recent value.</td><td> </td><td class="rblock">      TS.Recent value.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The following examples illustrate these rules.  Here A, B, C...</td><td> </td><td class="right">   The following examples illustrate these rules.  Here A, B, C...</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   represent data segments occupying successive blocks of sequence</td><td> </td><td class="right">   represent data segments occupying successive blocks of sequence</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0039" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   numbers, and ACK(A),... represent the corresponding acknowledgment</td><td> </td><td class="rblock">   numbers, and ACK(A),...  represent the corresponding acknowledgment</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   segments.  Note that ACK(A) has the same sequence number as B. We</td><td> </td><td class="rblock">   segments.  Note that ACK(A) has the same sequence number as B.  We</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   show only one direction of timestamp echoing, for clarity.</td><td> </td><td class="right">   show only one direction of timestamp echoing, for clarity.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   o  Packets arrive in sequence, and some of the ACKs are delayed.</td><td> </td><td class="right">   o  Packets arrive in sequence, and some of the ACKs are delayed.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      By case (A), the timestamp from the oldest unacknowledged segment</td><td> </td><td class="right">      By case (A), the timestamp from the oldest unacknowledged segment</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      is echoed.</td><td> </td><td class="right">      is echoed.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0040" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                    TS.Recent</td><td> </td><td class="rblock">                                                  TS.Recent</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                  &lt;A, TSval=1&gt; -------------------&gt;</td><td> </td><td class="rblock">                &lt;A, TSval=1&gt; -------------------&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                        1</td><td> </td><td class="rblock">                                                      1</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                  &lt;B, TSval=2&gt; -------------------&gt;</td><td> </td><td class="rblock">                &lt;B, TSval=2&gt; -------------------&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                        1</td><td> </td><td class="rblock">                                                      1</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                  &lt;C, TSval=3&gt; -------------------&gt;</td><td> </td><td class="rblock">                &lt;C, TSval=3&gt; -------------------&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                        1</td><td> </td><td class="rblock">                                                      1</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                           &lt;---- &lt;ACK(C), TSecr=1&gt;</td><td> </td><td class="rblock">                         &lt;---- &lt;ACK(C), TSecr=1&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                  (etc)</td><td> </td><td class="rblock">                (etc)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   o  Packets arrive out of order, and every packet is acknowledged.</td><td> </td><td class="right">   o  Packets arrive out of order, and every packet is acknowledged.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      By case (B), the timestamp from the last segment that advanced the</td><td> </td><td class="right">      By case (B), the timestamp from the last segment that advanced the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      left window edge is echoed, until the missing segment arrives; it</td><td> </td><td class="right">      left window edge is echoed, until the missing segment arrives; it</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      is echoed according to Case (C).  The same sequence would occur if</td><td> </td><td class="right">      is echoed according to Case (C).  The same sequence would occur if</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      segments B and D were lost and retransmitted.</td><td> </td><td class="right">      segments B and D were lost and retransmitted.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0041" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                    TS.Recent</td><td> </td><td class="rblock">                                                  TS.Recent</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                  &lt;A, TSval=1&gt; -------------------&gt;</td><td> </td><td class="rblock">                &lt;A, TSval=1&gt; -------------------&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                        1</td><td> </td><td class="rblock">                                                      1</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                           &lt;---- &lt;ACK(A), TSecr=1&gt;</td><td> </td><td class="rblock">                         &lt;---- &lt;ACK(A), TSecr=1&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                        1</td><td> </td><td class="rblock">                                                      1</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                  &lt;C, TSval=3&gt; -------------------&gt;</td><td> </td><td class="rblock">                &lt;C, TSval=3&gt; -------------------&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                        1</td><td> </td><td class="rblock">                                                      1</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                           &lt;---- &lt;ACK(A), TSecr=1&gt;</td><td> </td><td class="rblock">                         &lt;---- &lt;ACK(A), TSecr=1&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                        1</td><td> </td><td class="rblock">                                                      1</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                  &lt;B, TSval=2&gt; -------------------&gt;</td><td> </td><td class="rblock">                &lt;B, TSval=2&gt; -------------------&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                        2</td><td> </td><td class="rblock">                                                      2</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                           &lt;---- &lt;ACK(C), TSecr=2&gt;</td><td> </td><td class="rblock">                         &lt;---- &lt;ACK(C), TSecr=2&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                        2</td><td> </td><td class="rblock">                                                      2</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                  &lt;E, TSval=5&gt; -------------------&gt;</td><td> </td><td class="rblock">                &lt;E, TSval=5&gt; -------------------&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                        2</td><td> </td><td class="rblock">                                                      2</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                           &lt;---- &lt;ACK(C), TSecr=2&gt;</td><td> </td><td class="rblock">                         &lt;---- &lt;ACK(C), TSecr=2&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                        2</td><td> </td><td class="rblock">                                                      2</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                  &lt;D, TSval=4&gt; -------------------&gt;</td><td> </td><td class="rblock">                &lt;D, TSval=4&gt; -------------------&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                        4</td><td> </td><td class="rblock">                                                      4</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                           &lt;---- &lt;ACK(E), TSecr=4&gt;</td><td> </td><td class="rblock">                         &lt;---- &lt;ACK(E), TSecr=4&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                  (etc)</td><td> </td><td class="rblock">                                                                         </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                (etc)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">5.  PAWS -- Protection Against Wrapped Sequence Numbers</td><td> </td><td class="right">5.  PAWS -- Protection Against Wrapped Sequence Numbers</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">5.1.  Introduction</td><td> </td><td class="right">5.1.  Introduction</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Section 5.2 describes a simple mechanism to reject old duplicate</td><td> </td><td class="right">   Section 5.2 describes a simple mechanism to reject old duplicate</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   segments that might corrupt an open TCP connection; we call this</td><td> </td><td class="right">   segments that might corrupt an open TCP connection; we call this</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   mechanism PAWS (Protection Against Wrapped Sequence numbers).  PAWS</td><td> </td><td class="right">   mechanism PAWS (Protection Against Wrapped Sequence numbers).  PAWS</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   operates within a single TCP connection, using state that is saved in</td><td> </td><td class="right">   operates within a single TCP connection, using state that is saved in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the connection control block.  Section 5.3 and Appendix G discuss the</td><td> </td><td class="right">   the connection control block.  Section 5.3 and Appendix G discuss the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l7" /><small>skipping to change at</small><em> page 18, line 43</em></th><th> </th><th><a name="part-r7" /><small>skipping to change at</small><em> page 18, line 49</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   checks, and information from the Timestamps option MUST NOT be used</td><td> </td><td class="right">   checks, and information from the Timestamps option MUST NOT be used</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   to update connection state information.  SEG.TSecr MAY be used to</td><td> </td><td class="right">   to update connection state information.  SEG.TSecr MAY be used to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   provide stricter RST acceptance checks.</td><td> </td><td class="right">   provide stricter RST acceptance checks.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">5.2.1.  Basic PAWS Algorithm</td><td> </td><td class="right">5.2.1.  Basic PAWS Algorithm</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The PAWS algorithm requires the following processing to be performed</td><td> </td><td class="right">   The PAWS algorithm requires the following processing to be performed</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   on all incoming segments for a synchronized connection:</td><td> </td><td class="right">   on all incoming segments for a synchronized connection:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   R1)  If there is a Timestamps option in the arriving segment,</td><td> </td><td class="right">   R1)  If there is a Timestamps option in the arriving segment,</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0042" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        SEG.TSval &lt; TS.Recent, TS.Recent is valid (see later discussion)</td><td> </td><td class="rblock">      SEG.TSval &lt; TS.Recent, TS.Recent is valid (see later discussion)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        and the RST bit is not set, then treat the arriving segment as</td><td> </td><td class="rblock">      and the RST bit is not set, then treat the arriving segment as not</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        not acceptable:</td><td> </td><td class="rblock">      acceptable:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0043" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">           Send an acknowledgement in reply as specified in [RFC0793]</td><td> </td><td class="rblock">         Send an acknowledgement in reply as specified in [RFC0793] page</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">           page 69 and drop the segment.</td><td> </td><td class="rblock">         69 and drop the segment.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0044" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">           Note: it is necessary to send an ACK segment in order to</td><td> </td><td class="rblock">         Note: it is necessary to send an ACK segment in order to retain</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">           retain TCP's mechanisms for detecting and recovering from</td><td> </td><td class="rblock">         TCP's mechanisms for detecting and recovering from half-open</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">           half-open connections.  For example, see Figure 10 of</td><td> </td><td class="rblock">         connections.  For example, see Figure 10 of [RFC0793].</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">           [RFC0793].</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   R2)  If the segment is outside the window, reject it (normal TCP</td><td> </td><td class="right">   R2)  If the segment is outside the window, reject it (normal TCP</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0045" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      <span class="delete">  </span>processing)</td><td> </td><td class="rblock">      processing)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   R3)  If an arriving segment satisfies: SEG.SEQ &lt;= Last.ACK.sent (see</td><td> </td><td class="right">   R3)  If an arriving segment satisfies: SEG.SEQ &lt;= Last.ACK.sent (see</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0046" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      <span class="delete">  </span>Section 4.4), then record its timestamp in TS.Recent.</td><td> </td><td class="rblock">      Section 4.4), then record its timestamp in TS.Recent.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   R4)  If an arriving segment is in-sequence (i.e., at the left window</td><td> </td><td class="right">   R4)  If an arriving segment is in-sequence (i.e., at the left window</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0047" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      <span class="delete">  </span>edge), then accept it normally.</td><td> </td><td class="rblock">      edge), then accept it normally.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   R5)  Otherwise, treat the segment as a normal in-window, out-of-</td><td> </td><td class="right">   R5)  Otherwise, treat the segment as a normal in-window, out-of-</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0048" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        sequence TCP segment (e.g., queue it for later delivery to the</td><td> </td><td class="rblock">      sequence TCP segment (e.g., queue it for later delivery to the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        user).</td><td> </td><td class="rblock">      user).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Steps R2, R4, and R5 are the normal TCP processing steps specified by</td><td> </td><td class="right">   Steps R2, R4, and R5 are the normal TCP processing steps specified by</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [RFC0793].</td><td> </td><td class="right">   [RFC0793].</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   It is important to note that the timestamp is checked only when a</td><td> </td><td class="right">   It is important to note that the timestamp is checked only when a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   segment first arrives at the receiver, regardless of whether it is</td><td> </td><td class="right">   segment first arrives at the receiver, regardless of whether it is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   in-sequence or it must be queued for later delivery.</td><td> </td><td class="right">   in-sequence or it must be queued for later delivery.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Consider the following example.</td><td> </td><td class="right">   Consider the following example.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l8" /><small>skipping to change at</small><em> page 20, line 7</em></th><th> </th><th><a name="part-r8" /><small>skipping to change at</small><em> page 20, line 11</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   one packet will show up out-of-sequence to be queued at the receiver</td><td> </td><td class="right">   one packet will show up out-of-sequence to be queued at the receiver</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (e.g., up to ~2^30 bytes of data); the timestamp option must not</td><td> </td><td class="right">   (e.g., up to ~2^30 bytes of data); the timestamp option must not</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   result in discarding this data.</td><td> </td><td class="right">   result in discarding this data.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   In certain unlikely circumstances, the algorithm of rules R1-R5 could</td><td> </td><td class="right">   In certain unlikely circumstances, the algorithm of rules R1-R5 could</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   lead to discarding some segments unnecessarily, as shown in the</td><td> </td><td class="right">   lead to discarding some segments unnecessarily, as shown in the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   following example:</td><td> </td><td class="right">   following example:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Suppose again that segments: A.1, B.1, C.1, ..., Z.1 have been</td><td> </td><td class="right">      Suppose again that segments: A.1, B.1, C.1, ..., Z.1 have been</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      sent in sequence and that segment B.1 has been lost.  Furthermore,</td><td> </td><td class="right">      sent in sequence and that segment B.1 has been lost.  Furthermore,</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0049" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      suppose delivery of some of C.1, ... <span class="delete"> </span>Z.1 is delayed until AFTER</td><td> </td><td class="rblock">      suppose delivery of some of C.1, ... Z.1 is delayed until AFTER</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      the retransmission B.2 arrives at the receiver.  These delayed</td><td> </td><td class="right">      the retransmission B.2 arrives at the receiver.  These delayed</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      segments will be discarded unnecessarily when they do arrive,</td><td> </td><td class="right">      segments will be discarded unnecessarily when they do arrive,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      since their timestamps are now out of date.</td><td> </td><td class="right">      since their timestamps are now out of date.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   This case is very unlikely to occur.  If the retransmission was</td><td> </td><td class="right">   This case is very unlikely to occur.  If the retransmission was</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0050" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   triggered by a timeout, some of the segments C.1, ... <span class="delete"> </span>Z.1 must have</td><td> </td><td class="rblock">   triggered by a timeout, some of the segments C.1, ... Z.1 must have</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   been delayed longer than the RTO time.  This is presumably an</td><td> </td><td class="right">   been delayed longer than the RTO time.  This is presumably an</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   unlikely event, or there would be many spurious timeouts and</td><td> </td><td class="right">   unlikely event, or there would be many spurious timeouts and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   retransmissions.  If B's retransmission was triggered by the "fast</td><td> </td><td class="right">   retransmissions.  If B's retransmission was triggered by the "fast</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   retransmit" algorithm, i.e., by duplicate ACKs, then the queued</td><td> </td><td class="right">   retransmit" algorithm, i.e., by duplicate ACKs, then the queued</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   segments that caused these ACKs must have been received already.</td><td> </td><td class="right">   segments that caused these ACKs must have been received already.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Even if a segment were delayed past the RTO, the Fast Retransmit</td><td> </td><td class="right">   Even if a segment were delayed past the RTO, the Fast Retransmit</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   mechanism [Jacobson90c] will cause the delayed packets to be</td><td> </td><td class="right">   mechanism [Jacobson90c] will cause the delayed packets to be</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   retransmitted at the same time as B.2, avoiding an extra RTT and</td><td> </td><td class="right">   retransmitted at the same time as B.2, avoiding an extra RTT and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   therefore causing a very small performance penalty.</td><td> </td><td class="right">   therefore causing a very small performance penalty.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l9" /><small>skipping to change at</small><em> page 20, line 45</em></th><th> </th><th><a name="part-r9" /><small>skipping to change at</small><em> page 21, line 5</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   receiver treats the timestamp as simply a monotonically increasing</td><td> </td><td class="right">   receiver treats the timestamp as simply a monotonically increasing</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   serial number, without any necessary connection to its clock.  From</td><td> </td><td class="right">   serial number, without any necessary connection to its clock.  From</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the receiver's viewpoint, the timestamp is acting as a logical</td><td> </td><td class="right">   the receiver's viewpoint, the timestamp is acting as a logical</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   extension of the high-order bits of the sequence number.</td><td> </td><td class="right">   extension of the high-order bits of the sequence number.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The receiver algorithm does place some requirements on the frequency</td><td> </td><td class="right">   The receiver algorithm does place some requirements on the frequency</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   of the timestamp clock.</td><td> </td><td class="right">   of the timestamp clock.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (a)  The timestamp clock must not be "too slow".</td><td> </td><td class="right">   (a)  The timestamp clock must not be "too slow".</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0051" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        It MUST tick at least once for each 2^31 bytes sent.  In fact,</td><td> </td><td class="rblock">      It MUST tick at least once for each 2^31 bytes sent.  In fact, in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        in order to be useful to the sender for round trip timing, the</td><td> </td><td class="rblock">      order to be useful to the sender for round trip timing, the clock</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        clock SHOULD tick at least once per window's worth of data, and</td><td> </td><td class="rblock">      SHOULD tick at least once per window's worth of data, and even</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        even with the window extension defined in Section 3.2, 2^31</td><td> </td><td class="rblock">      with the window extension defined in Section 3.2, 2^31 bytes must</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        bytes must be at least two windows.</td><td> </td><td class="rblock">      be at least two windows.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        <span class="delete">To make this more quantitative, any clock faster than 1 tick/sec</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">        will reject old duplicate segments for link speeds of ~8 Gbps.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0052" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        A 1 ms timestamp clock will work at link speeds up to 8 Tbps</td><td> </td><td class="rblock">      <span class="insert">To make this more quantitative, any clock faster than 1 tick/sec</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        (8*10^12) bps!</td><td> </td><td class="rblock"><span class="insert">      will reject old duplicate segments for link speeds of ~8 Gbps.</span>  A</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">      1 ms timestamp clock will work at link speeds up to 8 Tbps</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">      (8*10^12) bps!</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (b)  The timestamp clock must not be "too fast".</td><td> </td><td class="right">   (b)  The timestamp clock must not be "too fast".</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0053" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        The recycling time of the timestamp clock MUST be greater than</td><td> </td><td class="rblock">      The recycling time of the timestamp clock MUST be greater than MSL</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        MSL seconds.  Since the clock (timestamp) is 32 bits and the</td><td> </td><td class="rblock">      seconds.  Since the clock (timestamp) is 32 bits and the <span class="insert">worst-</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        <span class="delete">worst-case</span> MSL is 255 seconds, the maximum acceptable clock</td><td> </td><td class="rblock"><span class="insert">      case</span> MSL is 255 seconds, the maximum acceptable clock frequency is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        frequency is one tick every 59 ns.</td><td> </td><td class="rblock">      one tick every 59 ns.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0054" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        However, it is desirable to establish a much longer recycle</td><td> </td><td class="rblock">      However, it is desirable to establish a much longer recycle</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        period, in order to handle outdated timestamps on idle</td><td> </td><td class="rblock">      period, in order to handle outdated timestamps on idle connections</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        connections (see Section 5.2.3), and to relax the MSL</td><td> </td><td class="rblock">      (see Section 5.2.3), and to relax the MSL requirement for</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        requirement for preventing sequence number wrap-around.  With a</td><td> </td><td class="rblock">      preventing sequence number wrap-around.  With a 1 ms timestamp</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        1 ms timestamp clock, the 32-bit timestamp will wrap its sign</td><td> </td><td class="rblock">      clock, the 32-bit timestamp will wrap its sign bit in 24.8 days.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        bit in 24.8 days.  Thus, it will reject old duplicates on the</td><td> </td><td class="rblock">      Thus, it will reject old duplicates on the same connection if MSL</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        same connection if MSL is 24.8 days or less.  This appears to be</td><td> </td><td class="rblock">      is 24.8 days or less.  This appears to be a very safe figure; an</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        a very safe figure; an MSL of 24.8 days or longer can probably</td><td> </td><td class="rblock">      MSL of 24.8 days or longer can probably be assumed in the internet</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        be assumed in the internet without requiring precise MSL</td><td> </td><td class="rblock">      without requiring precise MSL enforcement.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        enforcement.</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Based upon these considerations, we choose a timestamp clock</td><td> </td><td class="right">   Based upon these considerations, we choose a timestamp clock</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   frequency in the range 1 ms to 1 sec per tick.  This range also</td><td> </td><td class="right">   frequency in the range 1 ms to 1 sec per tick.  This range also</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   matches the requirements of the RTTM mechanism, which does not need</td><td> </td><td class="right">   matches the requirements of the RTTM mechanism, which does not need</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   much more resolution than the granularity of the retransmit timer,</td><td> </td><td class="right">   much more resolution than the granularity of the retransmit timer,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   e.g., tens or hundreds of milliseconds.</td><td> </td><td class="right">   e.g., tens or hundreds of milliseconds.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The PAWS mechanism also puts a strong monotonicity requirement on the</td><td> </td><td class="right">   The PAWS mechanism also puts a strong monotonicity requirement on the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   sender's timestamp clock.  The method of implementation of the</td><td> </td><td class="right">   sender's timestamp clock.  The method of implementation of the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   timestamp clock to meet this requirement depends upon the system</td><td> </td><td class="right">   timestamp clock to meet this requirement depends upon the system</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l10" /><small>skipping to change at</small><em> page 23, line 9</em></th><th> </th><th><a name="part-r10" /><small>skipping to change at</small><em> page 23, line 19</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   in sequence?"  This question can be answered in fewer machine</td><td> </td><td class="right">   in sequence?"  This question can be answered in fewer machine</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   instructions than the question, "Is this segment within the window?"</td><td> </td><td class="right">   instructions than the question, "Is this segment within the window?"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Adding header prediction to our timestamp procedure leads to the</td><td> </td><td class="right">   Adding header prediction to our timestamp procedure leads to the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   following recommended sequence for processing an arriving TCP</td><td> </td><td class="right">   following recommended sequence for processing an arriving TCP</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   segment:</td><td> </td><td class="right">   segment:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   H1)  Check timestamp (same as step R1 above)</td><td> </td><td class="right">   H1)  Check timestamp (same as step R1 above)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   H2)  Do header prediction: if segment is next in sequence and if</td><td> </td><td class="right">   H2)  Do header prediction: if segment is next in sequence and if</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0055" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        there are no special conditions requiring additional processing,</td><td> </td><td class="rblock">      there are no special conditions requiring additional processing,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        accept the segment, record its timestamp, and skip H3.</td><td> </td><td class="rblock">      accept the segment, record its timestamp, and skip H3.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   H3)  Process the segment normally, as specified in RFC 793.  This</td><td> </td><td class="right">   H3)  Process the segment normally, as specified in RFC 793.  This</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0056" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        includes dropping segments that are outside the window and</td><td> </td><td class="rblock">      includes dropping segments that are outside the window and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        possibly sending acknowledgments, and queuing in-window, out-of-</td><td> </td><td class="rblock">      possibly sending acknowledgments, and queuing in-window, out-of-</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        sequence segments.</td><td> </td><td class="rblock">      sequence segments.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Another possibility would be to interchange steps H1 and H2, i.e., to</td><td> </td><td class="right">   Another possibility would be to interchange steps H1 and H2, i.e., to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   perform the header prediction step H2 FIRST, and perform H1 and H3</td><td> </td><td class="right">   perform the header prediction step H2 FIRST, and perform H1 and H3</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   only when header prediction fails.  This could be a performance</td><td> </td><td class="right">   only when header prediction fails.  This could be a performance</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   improvement, since the timestamp check in step H1 is very unlikely to</td><td> </td><td class="right">   improvement, since the timestamp check in step H1 is very unlikely to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   fail, and it requires unsigned modulo arithmetic.  To perform this</td><td> </td><td class="right">   fail, and it requires unsigned modulo arithmetic.  To perform this</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   check on every single segment is contrary to the philosophy of header</td><td> </td><td class="right">   check on every single segment is contrary to the philosophy of header</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   prediction.  We believe that this change might produce a measurable</td><td> </td><td class="right">   prediction.  We believe that this change might produce a measurable</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   reduction in CPU time for TCP protocol processing on high-speed</td><td> </td><td class="right">   reduction in CPU time for TCP protocol processing on high-speed</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   networks.</td><td> </td><td class="right">   networks.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l11" /><small>skipping to change at</small><em> page 25, line 8</em></th><th> </th><th><a name="part-r11" /><small>skipping to change at</small><em> page 25, line 18</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   operation over large-bandwidth*delay-product paths and reliable</td><td> </td><td class="right">   operation over large-bandwidth*delay-product paths and reliable</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   operation over very high-speed paths.  These extensions are designed</td><td> </td><td class="right">   operation over very high-speed paths.  These extensions are designed</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   to provide compatible interworking with TCP's that do not implement</td><td> </td><td class="right">   to provide compatible interworking with TCP's that do not implement</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the extensions.</td><td> </td><td class="right">   the extensions.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   These mechanisms are implemented using new TCP options for scaled</td><td> </td><td class="right">   These mechanisms are implemented using new TCP options for scaled</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   windows and timestamps.  The timestamps are used for two distinct</td><td> </td><td class="right">   windows and timestamps.  The timestamps are used for two distinct</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   mechanisms: RTTM (Round Trip Time Measurement) and PAWS (Protection</td><td> </td><td class="right">   mechanisms: RTTM (Round Trip Time Measurement) and PAWS (Protection</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Against Wrapped Sequences).</td><td> </td><td class="right">   Against Wrapped Sequences).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0057" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   The Window Scale option was originally suggested by Mike St. Johns of</td><td> </td><td class="rblock">   The Window Scale option was originally suggested by Mike St.  Johns</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   USAF/DCA.  The present form of the option was suggested by Mike</td><td> </td><td class="rblock">   of USAF/DCA.  The present form of the option was suggested by Mike</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Karels of UC Berkeley in response to a more cumbersome scheme defined</td><td> </td><td class="right">   Karels of UC Berkeley in response to a more cumbersome scheme defined</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   by Van Jacobson.  Lixia Zhang helped formulate the PAWS mechanism</td><td> </td><td class="right">   by Van Jacobson.  Lixia Zhang helped formulate the PAWS mechanism</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   description in [RFC1185].</td><td> </td><td class="right">   description in [RFC1185].</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Finally, much of this work originated as the result of discussions</td><td> </td><td class="right">   Finally, much of this work originated as the result of discussions</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   within the End-to-End Task Force on the theoretical limitations of</td><td> </td><td class="right">   within the End-to-End Task Force on the theoretical limitations of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   transport protocols in general and TCP in particular.  Task force</td><td> </td><td class="right">   transport protocols in general and TCP in particular.  Task force</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   members and other on the end2end-interest list have made valuable</td><td> </td><td class="right">   members and other on the end2end-interest list have made valuable</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   contributions by pointing out flaws in the algorithms and the</td><td> </td><td class="right">   contributions by pointing out flaws in the algorithms and the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   documentation.  Continued discussion and development since the</td><td> </td><td class="right">   documentation.  Continued discussion and development since the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l12" /><small>skipping to change at</small><em> page 25, line 49</em></th><th> </th><th><a name="part-r12" /><small>skipping to change at</small><em> page 26, line 10</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   not have that protection.  In this situation, an implementer could</td><td> </td><td class="right">   not have that protection.  In this situation, an implementer could</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   provide a mechanism for the application to determine whether or not</td><td> </td><td class="right">   provide a mechanism for the application to determine whether or not</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   PAWS is in use on the connection, and chose to terminate the</td><td> </td><td class="right">   PAWS is in use on the connection, and chose to terminate the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   connection if that protection doesn't exist.</td><td> </td><td class="right">   connection if that protection doesn't exist.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Mechanisms to protect the TCP header from modification should also</td><td> </td><td class="right">   Mechanisms to protect the TCP header from modification should also</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   protect the TCP options.</td><td> </td><td class="right">   protect the TCP options.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Expanding the TCP window beyond 64K for IPv6 allows Jumbograms</td><td> </td><td class="right">   Expanding the TCP window beyond 64K for IPv6 allows Jumbograms</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [RFC2675] to be used when the local network supports packets larger</td><td> </td><td class="right">   [RFC2675] to be used when the local network supports packets larger</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0058" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   than 64K. When larger TCP packets are used, the TCP checksum becomes</td><td> </td><td class="rblock">   than 64K. <span class="insert"> </span>When larger TCP packets are used, the TCP checksum becomes</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   weaker.</td><td> </td><td class="right">   weaker.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">8.  IANA Considerations</td><td> </td><td class="right">8.  IANA Considerations</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   This document has no actions for IANA.</td><td> </td><td class="right">   This document has no actions for IANA.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">9.  References</td><td> </td><td class="right">9.  References</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">9.1.  Normative References</td><td> </td><td class="right">9.1.  Normative References</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0059" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   [RFC0793]  Postel, J., "Transmission Control Protocol", STD 7,</td><td> </td><td class="rblock">   [RFC0793]  Postel, J., "Transmission Control Protocol", STD 7, RFC</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              RFC 793, September 1981.</td><td> </td><td class="rblock">              793, September 1981.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [RFC1191]  Mogul, J. and S. Deering, "Path MTU discovery", RFC 1191,</td><td> </td><td class="right">   [RFC1191]  Mogul, J. and S. Deering, "Path MTU discovery", RFC 1191,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              November 1990.</td><td> </td><td class="right">              November 1990.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate</td><td> </td><td class="right">   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Requirement Levels", BCP 14, RFC 2119, March 1997.</td><td> </td><td class="right">              Requirement Levels", BCP 14, RFC 2119, March 1997.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">9.2.  Informative References</td><td> </td><td class="right">9.2.  Informative References</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [Garlick77]</td><td> </td><td class="right">   [Garlick77]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Garlick, L., Rom, R., and J. Postel, "Issues in Reliable</td><td> </td><td class="right">              Garlick, L., Rom, R., and J. Postel, "Issues in Reliable</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Host-to-Host Protocols", Proc. Second Berkeley Workshop on</td><td> </td><td class="right">              Host-to-Host Protocols", Proc. Second Berkeley Workshop on</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0060" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              Distributed Data Management and Computer Networks,</td><td> </td><td class="rblock">              Distributed Data Management and Computer Networks, May</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              May 1977, &lt;http://www.rfc-editor.org/ien/ien12.txt&gt;.</td><td> </td><td class="rblock">              1977, &lt;http://www.rfc-editor.org/ien/ien12.txt&gt;.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [Hamming77]</td><td> </td><td class="right">   [Hamming77]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Hamming, R., "Digital Filters", Prentice Hall, Englewood</td><td> </td><td class="right">              Hamming, R., "Digital Filters", Prentice Hall, Englewood</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Cliffs, N.J. ISBN 0-13-212571-4, 1977.</td><td> </td><td class="right">              Cliffs, N.J. ISBN 0-13-212571-4, 1977.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [Jacobson88a]</td><td> </td><td class="right">   [Jacobson88a]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Jacobson, V., "Congestion Avoidance and Control", SIGCOMM</td><td> </td><td class="right">              Jacobson, V., "Congestion Avoidance and Control", SIGCOMM</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0061" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              '88, Stanford, <span class="delete"> </span>CA., August 1988,</td><td> </td><td class="rblock">              '88, Stanford, CA., August 1988,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              &lt;http://ee.lbl.gov/papers/congavoid.pdf&gt;.</td><td> </td><td class="right">              &lt;http://ee.lbl.gov/papers/congavoid.pdf&gt;.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [Jacobson90a]</td><td> </td><td class="right">   [Jacobson90a]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Jacobson, V., "4BSD Header Prediction", ACM Computer</td><td> </td><td class="right">              Jacobson, V., "4BSD Header Prediction", ACM Computer</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Communication Review, April 1990.</td><td> </td><td class="right">              Communication Review, April 1990.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [Jacobson90c]</td><td> </td><td class="right">   [Jacobson90c]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Jacobson, V., "Modified TCP congestion avoidance</td><td> </td><td class="right">              Jacobson, V., "Modified TCP congestion avoidance</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              algorithm", Message to the end2end-interest mailing list,</td><td> </td><td class="right">              algorithm", Message to the end2end-interest mailing list,</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0062" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              April 1990,</td><td> </td><td class="rblock">              April 1990, <span class="insert">&lt;ftp://ftp.isi.edu/end2end/end2end-</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              <span class="delete">&lt;ftp://ftp.isi.edu/end2end/end2end-interest-1990.mail&gt;.</span></td><td> </td><td class="rblock"><span class="insert">              interest-1990.mail&gt;.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [Jain86]   Jain, R., "Divergence of Timeout Algorithms for Packet</td><td> </td><td class="right">   [Jain86]   Jain, R., "Divergence of Timeout Algorithms for Packet</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Retransmissions", Proc. Fifth Phoenix Conf. on Comp. and</td><td> </td><td class="right">              Retransmissions", Proc. Fifth Phoenix Conf. on Comp. and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Comm., Scottsdale, Arizona, March 1986,</td><td> </td><td class="right">              Comm., Scottsdale, Arizona, March 1986,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              &lt;http://arxiv.org/ftp/cs/papers/9809/9809097.pdf&gt;.</td><td> </td><td class="right">              &lt;http://arxiv.org/ftp/cs/papers/9809/9809097.pdf&gt;.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [Karn87]   Karn, P. and C. Partridge, "Estimating Round-Trip Times in</td><td> </td><td class="right">   [Karn87]   Karn, P. and C. Partridge, "Estimating Round-Trip Times in</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0063" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              Reliable Transport Protocols", Proc. SIGCOMM '87,</td><td> </td><td class="rblock">              Reliable Transport Protocols", Proc. SIGCOMM '87, August</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              August 1987.</td><td> </td><td class="rblock">              1987.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [Martin03]</td><td> </td><td class="right">   [Martin03]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Martin, D., "[Tsvwg] RFC 1323.bis", Message to the tsvwg</td><td> </td><td class="right">              Martin, D., "[Tsvwg] RFC 1323.bis", Message to the tsvwg</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0064" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              mailing list, September 2003, <span class="delete">&lt;http://www.ietf.org/</span></td><td> </td><td class="rblock">              mailing list, September 2003, <span class="insert">&lt;http://www.ietf.org/mail-</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">              mail-archive/web/tsvwg/current/msg04435.html&gt;.</span></td><td> </td><td class="rblock"><span class="insert">              archive/web/tsvwg/current/msg04435.html&gt;.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [Mathis08]</td><td> </td><td class="right">   [Mathis08]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Mathis, M., "[tcpm] Example of 1323 window retraction</td><td> </td><td class="right">              Mathis, M., "[tcpm] Example of 1323 window retraction</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              problem", Message to the tcpm mailing list, March 2008,</td><td> </td><td class="right">              problem", Message to the tcpm mailing list, March 2008,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              &lt;http://www.ietf.org/mail-archive/web/tcpm/current/</td><td> </td><td class="right">              &lt;http://www.ietf.org/mail-archive/web/tcpm/current/</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              msg03564.html&gt;.</td><td> </td><td class="right">              msg03564.html&gt;.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [RFC0896]  Nagle, J., "Congestion control in IP/TCP internetworks",</td><td> </td><td class="right">   [RFC0896]  Nagle, J., "Congestion control in IP/TCP internetworks",</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              RFC 896, January 1984.</td><td> </td><td class="right">              RFC 896, January 1984.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l13" /><small>skipping to change at</small><em> page 28, line 18</em></th><th> </th><th><a name="part-r13" /><small>skipping to change at</small><em> page 28, line 26</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Discovery", RFC 4821, March 2007.</td><td> </td><td class="right">              Discovery", RFC 4821, March 2007.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [RFC4963]  Heffner, J., Mathis, M., and B. Chandler, "IPv4 Reassembly</td><td> </td><td class="right">   [RFC4963]  Heffner, J., Mathis, M., and B. Chandler, "IPv4 Reassembly</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Errors at High Data Rates", RFC 4963, July 2007.</td><td> </td><td class="right">              Errors at High Data Rates", RFC 4963, July 2007.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [RFC5681]  Allman, M., Paxson, V., and E. Blanton, "TCP Congestion</td><td> </td><td class="right">   [RFC5681]  Allman, M., Paxson, V., and E. Blanton, "TCP Congestion</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Control", RFC 5681, September 2009.</td><td> </td><td class="right">              Control", RFC 5681, September 2009.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [RFC6675]  Blanton, E., Allman, M., Wang, L., Jarvinen, I., Kojo, M.,</td><td> </td><td class="right">   [RFC6675]  Blanton, E., Allman, M., Wang, L., Jarvinen, I., Kojo, M.,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              and Y. Nishida, "A Conservative Loss Recovery Algorithm</td><td> </td><td class="right">              and Y. Nishida, "A Conservative Loss Recovery Algorithm</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0065" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              Based on Selective Acknowledgment (SACK) for TCP",</td><td> </td><td class="rblock">              Based on Selective Acknowledgment (SACK) for TCP", RFC</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              RFC 6675, August 2012.</td><td> </td><td class="rblock">              6675, August 2012.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [Watson81]</td><td> </td><td class="right">   [Watson81]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Watson, R., "Timer-based Mechanisms in Reliable Transport</td><td> </td><td class="right">              Watson, R., "Timer-based Mechanisms in Reliable Transport</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Protocol Connection Management", Computer Networks, Vol.</td><td> </td><td class="right">              Protocol Connection Management", Computer Networks, Vol.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              5, 1981.</td><td> </td><td class="right">              5, 1981.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [Zhang86]  Zhang, L., "Why TCP Timers Don't Work Well", Proc. SIGCOMM</td><td> </td><td class="right">   [Zhang86]  Zhang, L., "Why TCP Timers Don't Work Well", Proc. SIGCOMM</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              '86, Stowe, VT, August 1986.</td><td> </td><td class="right">              '86, Stowe, VT, August 1986.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Appendix A.  Implementation Suggestions</td><td> </td><td class="right">Appendix A.  Implementation Suggestions</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l14" /><small>skipping to change at</small><em> page 29, line 7</em></th><th> </th><th><a name="part-r14" /><small>skipping to change at</small><em> page 29, line 14</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Interaction with the TCP Urgent Pointer</td><td> </td><td class="right">   Interaction with the TCP Urgent Pointer</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      The TCP Urgent pointer, like the TCP window, is a 16 bit value.</td><td> </td><td class="right">      The TCP Urgent pointer, like the TCP window, is a 16 bit value.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Some of the original discussion for the TCP Window Scale option</td><td> </td><td class="right">      Some of the original discussion for the TCP Window Scale option</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      included proposals to increase the Urgent pointer to 32 bits.  As</td><td> </td><td class="right">      included proposals to increase the Urgent pointer to 32 bits.  As</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      it turns out, this is unnecessary.  There are two observations</td><td> </td><td class="right">      it turns out, this is unnecessary.  There are two observations</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      that should be made:</td><td> </td><td class="right">      that should be made:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      (1)  With IP Version 4, the largest amount of TCP data that can be</td><td> </td><td class="right">      (1)  With IP Version 4, the largest amount of TCP data that can be</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0066" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">           sent in a single packet is 65495 bytes (64K - 1 -- size of</td><td> </td><td class="rblock">            sent in a single packet is 65495 bytes (64K - 1 -- size of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">           fixed IP and TCP headers).</td><td> </td><td class="rblock">            fixed IP and TCP headers).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      (2)  Updates to the urgent pointer while the user is in "urgent</td><td> </td><td class="right">      (2)  Updates to the urgent pointer while the user is in "urgent</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0067" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">           mode" are invisible to the user.</td><td> </td><td class="rblock">           <span class="insert"> </span>mode" are invisible to the user.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      This means that if the Urgent Pointer points beyond the end of the</td><td> </td><td class="right">      This means that if the Urgent Pointer points beyond the end of the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      TCP data in the current packet, then the user will remain in</td><td> </td><td class="right">      TCP data in the current packet, then the user will remain in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      urgent mode until the next TCP packet arrives.  That packet will</td><td> </td><td class="right">      urgent mode until the next TCP packet arrives.  That packet will</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      update the urgent pointer to a new offset, and the user will never</td><td> </td><td class="right">      update the urgent pointer to a new offset, and the user will never</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      have left urgent mode.</td><td> </td><td class="right">      have left urgent mode.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Thus, to properly implement the Urgent Pointer, the sending TCP</td><td> </td><td class="right">      Thus, to properly implement the Urgent Pointer, the sending TCP</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      only has to check for overflow of the 16 bit Urgent Pointer field</td><td> </td><td class="right">      only has to check for overflow of the 16 bit Urgent Pointer field</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      before filling it in.  If it does overflow, than a value of 65535</td><td> </td><td class="right">      before filling it in.  If it does overflow, than a value of 65535</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l15" /><small>skipping to change at</small><em> page 30, line 29</em></th><th> </th><th><a name="part-r15" /><small>skipping to change at</small><em> page 30, line 35</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   When a TCP connection is closed, a delay of 2*MSL in TIME-WAIT state</td><td> </td><td class="right">   When a TCP connection is closed, a delay of 2*MSL in TIME-WAIT state</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ties up the socket pair for 4 minutes (see Section 3.5 of [RFC0793].</td><td> </td><td class="right">   ties up the socket pair for 4 minutes (see Section 3.5 of [RFC0793].</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Applications built upon TCP that close one connection and open a new</td><td> </td><td class="right">   Applications built upon TCP that close one connection and open a new</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   one (e.g., an FTP data transfer connection using Stream mode) must</td><td> </td><td class="right">   one (e.g., an FTP data transfer connection using Stream mode) must</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   choose a new socket pair each time.  The TIME-WAIT delay serves two</td><td> </td><td class="right">   choose a new socket pair each time.  The TIME-WAIT delay serves two</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   different purposes:</td><td> </td><td class="right">   different purposes:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (a)  Implement the full-duplex reliable close handshake of TCP.</td><td> </td><td class="right">   (a)  Implement the full-duplex reliable close handshake of TCP.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0068" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        The proper time to delay the final close step is not really</td><td> </td><td class="rblock">      The proper time to delay the final close step is not really</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        related to the MSL; it depends instead upon the RTO for the FIN</td><td> </td><td class="rblock">      related to the MSL; it depends instead upon the RTO for the FIN</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        segments and therefore upon the RTT of the path.  (It could be</td><td> </td><td class="rblock">      segments and therefore upon the RTT of the path.  (It could be</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        argued that the side that is sending a FIN knows what degree of</td><td> </td><td class="rblock">      argued that the side that is sending a FIN knows what degree of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        reliability it needs, and therefore it should be able to</td><td> </td><td class="rblock">      reliability it needs, and therefore it should be able to determine</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        determine the length of the TIME-WAIT delay for the FIN's</td><td> </td><td class="rblock">      the length of the TIME-WAIT delay for the FIN's recipient.  This</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        recipient.  This could be accomplished with an appropriate TCP</td><td> </td><td class="rblock">      could be accomplished with an appropriate TCP option in FIN</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        option in FIN segments.)</td><td> </td><td class="rblock">      segments.)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0069" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        Although there is no formal upper-bound on RTT, common network</td><td> </td><td class="rblock">      Although there is no formal upper-bound on RTT, common network</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        engineering practice makes an RTT greater than 1 minute very</td><td> </td><td class="rblock">      engineering practice makes an RTT greater than 1 minute very</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        unlikely.  Thus, the 4 minute delay in TIME-WAIT state works</td><td> </td><td class="rblock">      unlikely.  Thus, the 4 minute delay in TIME-WAIT state works</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        satisfactorily to provide a reliable full-duplex TCP close.</td><td> </td><td class="rblock">      satisfactorily to provide a reliable full-duplex TCP close.  Note</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        Note again that this is independent of MSL enforcement and</td><td> </td><td class="rblock">      again that this is independent of MSL enforcement and network</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        network speed.</td><td> </td><td class="rblock">      speed.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0070" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        The TIME-WAIT state could cause an indirect performance problem</td><td> </td><td class="rblock">      The TIME-WAIT state could cause an indirect performance problem if</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        if an application needed to repeatedly close one connection and</td><td> </td><td class="rblock">      an application needed to repeatedly close one connection and open</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        open another at a very high frequency, since the number of</td><td> </td><td class="rblock">      another at a very high frequency, since the number of available</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        available TCP ports on a host is less than 2^16.  However, high</td><td> </td><td class="rblock">      TCP ports on a host is less than 2^16.  However, high network</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        network speeds are not the major contributor to this problem;</td><td> </td><td class="rblock">      speeds are not the major contributor to this problem; the RTT is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        the RTT is the limiting factor in how quickly connections can be</td><td> </td><td class="rblock">      the limiting factor in how quickly connections can be opened and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        opened and closed.  Therefore, this problem will be no worse at</td><td> </td><td class="rblock">      closed.  Therefore, this problem will be no worse at high transfer</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        high transfer speeds.</td><td> </td><td class="rblock">      speeds.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (b)  Allow old duplicate segments to expire.</td><td> </td><td class="right">   (b)  Allow old duplicate segments to expire.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0071" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        To replace this function of TIME-WAIT state, a mechanism would</td><td> </td><td class="rblock">      To replace this function of TIME-WAIT state, a mechanism would</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        have to operate across connections.  PAWS is defined strictly</td><td> </td><td class="rblock">      have to operate across connections.  PAWS is defined strictly</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        within a single connection; the last timestamp (TS.Recent) is</td><td> </td><td class="rblock">      within a single connection; the last timestamp (TS.Recent) is kept</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        kept in the connection control block, and discarded when a</td><td> </td><td class="rblock">      in the connection control block, and discarded when a connection</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        connection is closed.</td><td> </td><td class="rblock">      is closed.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0072" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        An additional mechanism could be added to the TCP, a per-host</td><td> </td><td class="rblock">      An additional mechanism could be added to the TCP, a per-host</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        cache of the last timestamp received from any connection.  This</td><td> </td><td class="rblock">      cache of the last timestamp received from any connection.  This</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        value could then be used in the PAWS mechanism to reject old</td><td> </td><td class="rblock">      value could then be used in the PAWS mechanism to reject old</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        duplicate segments from earlier incarnations of the connection,</td><td> </td><td class="rblock">      duplicate segments from earlier incarnations of the connection, if</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        if the timestamp clock can be guaranteed to have ticked at least</td><td> </td><td class="rblock">      the timestamp clock can be guaranteed to have ticked at least once</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        once since the old connection was open.  This would require that</td><td> </td><td class="rblock">      since the old connection was open.  This would require that the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        the TIME-WAIT delay plus the RTT together must be at least one</td><td> </td><td class="rblock">      TIME-WAIT delay plus the RTT together must be at least one tick of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        tick of the sender's timestamp clock.  Such an extension is not</td><td> </td><td class="rblock">      the sender's timestamp clock.  Such an extension is not part of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        part of the proposal of this RFC.</td><td> </td><td class="rblock">      the proposal of this RFC.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0073" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        Note that this is a variant on the mechanism proposed by</td><td> </td><td class="rblock">      Note that this is a variant on the mechanism proposed by Garlick,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        Garlick, Rom, and Postel [Garlick77], which required each host</td><td> </td><td class="rblock">      Rom, and Postel [Garlick77], which required each host to maintain</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        to maintain connection records containing the highest sequence</td><td> </td><td class="rblock">      connection records containing the highest sequence numbers on</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        numbers on every connection.  Using timestamps instead, it is</td><td> </td><td class="rblock">      every connection.  Using timestamps instead, it is only necessary</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        only necessary to keep one quantity per remote host, regardless</td><td> </td><td class="rblock">      to keep one quantity per remote host, regardless of the number of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        of the number of simultaneous connections to that host.</td><td> </td><td class="rblock">      simultaneous connections to that host.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Appendix C.  Summary of Notation</td><td> </td><td class="right">Appendix C.  Summary of Notation</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The following notation has been used in this document.</td><td> </td><td class="right">   The following notation has been used in this document.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Options</td><td> </td><td class="right">   Options</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      WSopt:            TCP Window Scale Option</td><td> </td><td class="right">      WSopt:            TCP Window Scale Option</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      TSopt:            TCP Timestamps Option</td><td> </td><td class="right">      TSopt:            TCP Timestamps Option</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l16" /><small>skipping to change at</small><em> page 32, line 34</em></th><th> </th><th><a name="part-r16" /><small>skipping to change at</small><em> page 32, line 39</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                        sent (used by pre-1323 code).</td><td> </td><td class="right">                        sent (used by pre-1323 code).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Procedure</td><td> </td><td class="right">   Procedure</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Update_SRTT(m)    Procedure to update the smoothed RTT and RTT</td><td> </td><td class="right">      Update_SRTT(m)    Procedure to update the smoothed RTT and RTT</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                        variance estimates, using the rules of</td><td> </td><td class="right">                        variance estimates, using the rules of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                        [Jacobson88a], given m, a new RTT measurement</td><td> </td><td class="right">                        [Jacobson88a], given m, a new RTT measurement</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Appendix D.  Pseudo-code Summary</td><td> </td><td class="right">Appendix D.  Pseudo-code Summary</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0074" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Create new TCB =&gt; {</td><td> </td><td class="rblock">      Create new TCB =&gt; {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       Rcv.wind.scale =</td><td> </td><td class="rblock">          Rcv.wind.scale =</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">             MIN( 14, MAX(0, floor(log2(receive buffer space)) - 15) );</td><td> </td><td class="rblock">                MIN( 14, MAX(0, floor(log2(receive buffer space)) - 15) );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       Snd.wind.scale = 0;</td><td> </td><td class="rblock">          Snd.wind.scale = 0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       Last.ACK.sent = 0;</td><td> </td><td class="rblock">          Last.ACK.sent = 0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       Snd.TS.OK = Snd.WS.OK = FALSE;</td><td> </td><td class="rblock">          Snd.TS.OK = Snd.WS.OK = FALSE;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       Snd.TSoffset = random 32 bit value</td><td> </td><td class="rblock">          Snd.TSoffset = random 32 bit value</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   }</td><td> </td><td class="rblock">      }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0075" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Send initial &lt;SYN&gt; segment =&gt; {</td><td> </td><td class="rblock">      Send initial &lt;SYN&gt; segment =&gt; {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       SEG.WND = MIN( RCV.WND, 65535 );</td><td> </td><td class="rblock">          SEG.WND = MIN( RCV.WND, 65535 );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       Include in segment: TSopt(TSval=Snd.TSclock, TSecr=0);</td><td> </td><td class="rblock">          Include in segment: TSopt(TSval=Snd.TSclock, TSecr=0);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       Include in segment: WSopt = Rcv.wind.scale;</td><td> </td><td class="rblock">          Include in segment: WSopt = Rcv.wind.scale;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   }</td><td> </td><td class="rblock">      }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0076" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Send &lt;SYN,ACK&gt; segment =&gt; {</td><td> </td><td class="rblock">      Send &lt;SYN,ACK&gt; segment =&gt; {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       SEG.ACK = Last.ACK.sent = RCV.NXT;</td><td> </td><td class="rblock">          SEG.ACK = Last.ACK.sent = RCV.NXT;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       SEG.WND = MIN( RCV.WND, 65535 );</td><td> </td><td class="rblock">          SEG.WND = MIN( RCV.WND, 65535 );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if (Snd.TS.OK) then</td><td> </td><td class="rblock">          if (Snd.TS.OK) then</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">             Include in segment:</td><td> </td><td class="rblock">                Include in segment:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                   TSopt(TSval=Snd.TSclock, TSecr=TS.Recent);</td><td> </td><td class="rblock">                      TSopt(TSval=Snd.TSclock, TSecr=TS.Recent);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if (Snd.WS.OK) then</td><td> </td><td class="rblock">          if (Snd.WS.OK) then</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">             Include in segment: WSopt = Rcv.wind.scale;</td><td> </td><td class="rblock">                Include in segment: WSopt = Rcv.wind.scale;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   }</td><td> </td><td class="rblock">      }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0077" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Receive &lt;SYN&gt; or &lt;SYN,ACK&gt; segment =&gt; {</td><td> </td><td class="rblock">      Receive &lt;SYN&gt; or &lt;SYN,ACK&gt; segment =&gt; {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if (Segment contains TSopt) then {</td><td> </td><td class="rblock">          if (Segment contains TSopt) then {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">             TS.Recent = SEG.TSval;</td><td> </td><td class="rblock">                TS.Recent = SEG.TSval;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">             Snd.TS.OK = TRUE;</td><td> </td><td class="rblock">                Snd.TS.OK = TRUE;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">             if (is &lt;SYN,ACK&gt; segment) then</td><td> </td><td class="rblock">                if (is &lt;SYN,ACK&gt; segment) then</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                   Update_SRTT(</td><td> </td><td class="rblock">                      Update_SRTT(</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                          (Snd.TSclock - SEG.TSecr)/my.TSclock.rate);</td><td> </td><td class="rblock">                             (Snd.TSclock - SEG.TSecr)/my.TSclock.rate);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       }</td><td> </td><td class="rblock">          }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if (Segment contains WSopt) then {</td><td> </td><td class="rblock">          if (Segment contains WSopt) then {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">             Snd.wind.scale = SEG.WSopt;</td><td> </td><td class="rblock">                Snd.wind.scale = SEG.WSopt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">             Snd.WS.OK = TRUE;</td><td> </td><td class="rblock">                Snd.WS.OK = TRUE;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">             if (the ACK bit is not set, and Rcv.wind.scale has not been</td><td> </td><td class="rblock">                if (the ACK bit is not set, and Rcv.wind.scale has not been</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               initialized by the user) then</td><td> </td><td class="rblock">                  initialized by the user) then</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                   Rcv.wind.scale = Snd.wind.scale;</td><td> </td><td class="rblock">                      Rcv.wind.scale = Snd.wind.scale;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       }</td><td> </td><td class="rblock">          }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       else</td><td> </td><td class="rblock">          else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">             Rcv.wind.scale = Snd.wind.scale = 0;</td><td> </td><td class="rblock">                Rcv.wind.scale = Snd.wind.scale = 0;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   }</td><td> </td><td class="rblock">      }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0078" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Send non-SYN segment =&gt; {</td><td> </td><td class="rblock">      Send non-SYN segment =&gt; {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       SEG.ACK = Last.ACK.sent = RCV.NXT;</td><td> </td><td class="rblock">          SEG.ACK = Last.ACK.sent = RCV.NXT;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       SEG.WND = MIN( RCV.WND &gt;&gt; Rcv.wind.scale, 65535 );</td><td> </td><td class="rblock">          SEG.WND = MIN( RCV.WND &gt;&gt; Rcv.wind.scale, 65535 );</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if (Snd.TS.OK) then</td><td> </td><td class="rblock">          if (Snd.TS.OK) then</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">             Include in segment:</td><td> </td><td class="rblock">                Include in segment:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                   TSopt(TSval=Snd.TSclock, TSecr=TS.Recent);</td><td> </td><td class="rblock">                      TSopt(TSval=Snd.TSclock, TSecr=TS.Recent);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   }</td><td> </td><td class="rblock">      }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0079" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Receive non-SYN segment in (state &gt;= ESTABLISHED) =&gt; {</td><td> </td><td class="rblock">      Receive non-SYN segment in (state &gt;= ESTABLISHED) =&gt; {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       Window = (SEG.WND &lt;&lt; Snd.wind.scale);</td><td> </td><td class="rblock">          Window = (SEG.WND &lt;&lt; Snd.wind.scale);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">             /* Use 32-bit 'Window' instead of 16-bit 'SEG.WND'</td><td> </td><td class="rblock">                /* Use 32-bit 'Window' instead of 16-bit 'SEG.WND'</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              * in rest of processing.</td><td> </td><td class="rblock">                 * in rest of processing.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">              */</td><td> </td><td class="rblock">                 */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if (Segment contains TSopt) then {</td><td> </td><td class="rblock">          if (Segment contains TSopt) then {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">             if (SEG.TSval &lt; TS.Recent &amp;&amp; Idle less than 24 days) then {</td><td> </td><td class="rblock">                if (SEG.TSval &lt; TS.Recent &amp;&amp; Idle less than 24 days) then {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                   if (Send.TS.OK AND (NOT RST) ) then {</td><td> </td><td class="rblock">                      if (Send.TS.OK AND (NOT RST) ) then {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               /* Timestamp too old =&gt;</td><td> </td><td class="rblock">                                  /* Timestamp too old =&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                *    segment is unacceptable.</td><td> </td><td class="rblock">                                   *    segment is unacceptable.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                */</td><td> </td><td class="rblock">                                   */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                         Send ACK segment;</td><td> </td><td class="rblock">                            Send ACK segment;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                         Discard segment and return;</td><td> </td><td class="rblock">                            Discard segment and return;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                   }</td><td> </td><td class="rblock">                      }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">             }</td><td> </td><td class="rblock">                }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">             else {</td><td> </td><td class="rblock">                else {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                   if (SEG.SEQ &lt;= Last.ACK.sent) then</td><td> </td><td class="rblock">                      if (SEG.SEQ &lt;= Last.ACK.sent) then</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                               TS.Recent = SEG.TSval;</td><td> </td><td class="rblock">                                  TS.Recent = SEG.TSval;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">             }</td><td> </td><td class="rblock">                }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       }</td><td> </td><td class="rblock">          }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       if (SEG.ACK &gt; SND.UNA) then {</td><td> </td><td class="rblock">          if (SEG.ACK &gt; SND.UNA) then {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                    /* (At least part of) first segment in</td><td> </td><td class="rblock">                       /* (At least part of) first segment in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                     * retransmission queue has been ACKed</td><td> </td><td class="rblock">                        * retransmission queue has been ACKed</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                     */</td><td> </td><td class="rblock">                        */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">             if (Segment contains TSopt) then</td><td> </td><td class="rblock">                if (Segment contains TSopt) then</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                   Update_SRTT(</td><td> </td><td class="rblock">                      Update_SRTT(</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                          (Snd.TSclock - SEG.TSecr)/my.TSclock.rate);</td><td> </td><td class="rblock">                             (Snd.TSclock - SEG.TSecr)/my.TSclock.rate);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">             else</td><td> </td><td class="rblock">                else</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                   Update_SRTT( /* for compatibility */</td><td> </td><td class="rblock">                      Update_SRTT( /* for compatibility */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                          (Snd.TSclock - Start.Time)/my.TSclock.rate);</td><td> </td><td class="rblock">                             (Snd.TSclock - Start.Time)/my.TSclock.rate);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       }</td><td> </td><td class="rblock">          }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   }</td><td> </td><td class="rblock">      }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Appendix E.  Event Processing Summary</td><td> </td><td class="right">Appendix E.  Event Processing Summary</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   OPEN Call</td><td> </td><td class="right">   OPEN Call</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      ...</td><td> </td><td class="right">      ...</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      An initial send sequence number (ISS) is selected.  Send a SYN</td><td> </td><td class="right">      An initial send sequence number (ISS) is selected.  Send a SYN</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      segment of the form:</td><td> </td><td class="right">      segment of the form:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l17" /><small>skipping to change at</small><em> page 34, line 50</em></th><th> </th><th><a name="part-r17" /><small>skipping to change at</small><em> page 35, line 14</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      CLOSED STATE (i.e., TCB does not exist)</td><td> </td><td class="right">      CLOSED STATE (i.e., TCB does not exist)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">         ...</td><td> </td><td class="right">         ...</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      LISTEN STATE</td><td> </td><td class="right">      LISTEN STATE</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">         If the foreign socket is specified, then change the connection</td><td> </td><td class="right">         If the foreign socket is specified, then change the connection</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">         from passive to active, select an ISS.  Send a SYN segment</td><td> </td><td class="right">         from passive to active, select an ISS.  Send a SYN segment</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">         containing the options: &lt;TSval=Snd.TSclock&gt; and</td><td> </td><td class="right">         containing the options: &lt;TSval=Snd.TSclock&gt; and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">         &lt;WSopt=Rcv.Wind.Scale&gt;.  Set SND.UNA to ISS, SND.NXT to ISS+1.</td><td> </td><td class="right">         &lt;WSopt=Rcv.Wind.Scale&gt;.  Set SND.UNA to ISS, SND.NXT to ISS+1.</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0080" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">         Enter SYN-SENT state. ...</td><td> </td><td class="rblock">         Enter SYN-SENT state. <span class="insert"> </span>...</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      SYN-SENT STATE</td><td> </td><td class="right">      SYN-SENT STATE</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      SYN-RECEIVED STATE</td><td> </td><td class="right">      SYN-RECEIVED STATE</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">         ...</td><td> </td><td class="right">         ...</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      ESTABLISHED STATE</td><td> </td><td class="right">      ESTABLISHED STATE</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      CLOSE-WAIT STATE</td><td> </td><td class="right">      CLOSE-WAIT STATE</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">         Segmentize the buffer and send it with a piggybacked</td><td> </td><td class="right">         Segmentize the buffer and send it with a piggybacked</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0081" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">         acknowledgment (acknowledgment value = RCV.NXT). ...</td><td> </td><td class="rblock">         acknowledgment (acknowledgment value = RCV.NXT). <span class="insert"> </span>...</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">         If the urgent flag is set ...</td><td> </td><td class="right">         If the urgent flag is set ...</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">         If the Snd.TS.OK flag is set, then include the TCP Timestamps</td><td> </td><td class="right">         If the Snd.TS.OK flag is set, then include the TCP Timestamps</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">         option &lt;TSval=Snd.TSclock,TSecr=TS.Recent&gt; in each data</td><td> </td><td class="right">         option &lt;TSval=Snd.TSclock,TSecr=TS.Recent&gt; in each data</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">         segment.</td><td> </td><td class="right">         segment.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">         Scale the receive window for transmission in the segment</td><td> </td><td class="right">         Scale the receive window for transmission in the segment</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">         header:</td><td> </td><td class="right">         header:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0082" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                  <span class="delete"> </span>SEG.WND = (RCV.WND &gt;&gt; Rcv.Wind.Scale).</td><td> </td><td class="rblock">                  SEG.WND = (RCV.WND &gt;&gt; Rcv.Wind.Scale).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   SEGMENT ARRIVES</td><td> </td><td class="right">   SEGMENT ARRIVES</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      ...</td><td> </td><td class="right">      ...</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      If the state is LISTEN then</td><td> </td><td class="right">      If the state is LISTEN then</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">         first check for an RST</td><td> </td><td class="right">         first check for an RST</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            ...</td><td> </td><td class="right">            ...</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l18" /><small>skipping to change at</small><em> page 40, line 11</em></th><th> </th><th><a name="part-r18" /><small>skipping to change at</small><em> page 40, line 29</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   incorrect RTTM can be calculated.  All of these situations involve</td><td> </td><td class="right">   incorrect RTTM can be calculated.  All of these situations involve</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the loss of packets.  It is felt that these scenarios are rare, and</td><td> </td><td class="right">   the loss of packets.  It is felt that these scenarios are rare, and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   that if they should happen, they will cause a single RTTM measurement</td><td> </td><td class="right">   that if they should happen, they will cause a single RTTM measurement</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   to be inflated, which mitigates its effects on RTO calculations.</td><td> </td><td class="right">   to be inflated, which mitigates its effects on RTO calculations.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [Martin03] cites two similar cases when the returning ACK is lost,</td><td> </td><td class="right">   [Martin03] cites two similar cases when the returning ACK is lost,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   and before the retransmission timer fires, another returning packet</td><td> </td><td class="right">   and before the retransmission timer fires, another returning packet</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   arrives, which ACKs the data.  In this case, the RTTM calculated will</td><td> </td><td class="right">   arrives, which ACKs the data.  In this case, the RTTM calculated will</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   be inflated:</td><td> </td><td class="right">   be inflated:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0083" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">           clock</td><td> </td><td class="rblock">          clock</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">             tc=1   &lt;A, TSval=1&gt; -------------------&gt;</td><td> </td><td class="rblock">            tc=1   &lt;A, TSval=1&gt; -------------------&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0084" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">             tc=2   (lost) &lt;---- &lt;ACK(A), TSecr=1, win=n&gt;</td><td> </td><td class="rblock">            tc=2   (lost) &lt;---- &lt;ACK(A), TSecr=1, win=n&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                 (RTTM would have been 1)</td><td> </td><td class="rblock">                (RTTM would have been 1)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0085" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                    (receive window opens, window update is sent)</td><td> </td><td class="rblock">                   (receive window opens, window update is sent)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">             tc=5        &lt;---- &lt;ACK(A), TSecr=1, win=m&gt;</td><td> </td><td class="rblock">            tc=5        &lt;---- &lt;ACK(A), TSecr=1, win=m&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                    (RTTM is calculated at 4)</td><td> </td><td class="rblock">                   (RTTM is calculated at 4)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   One thing to note about this situation is that it is somewhat bounded</td><td> </td><td class="right">   One thing to note about this situation is that it is somewhat bounded</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   by RTO + RTT, limiting how far off the RTTM calculation will be.</td><td> </td><td class="right">   by RTO + RTT, limiting how far off the RTTM calculation will be.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   While more complex scenarios can be constructed that produce larger</td><td> </td><td class="right">   While more complex scenarios can be constructed that produce larger</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   inflations (e.g., retransmissions are lost), those scenarios involve</td><td> </td><td class="right">   inflations (e.g., retransmissions are lost), those scenarios involve</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   multiple packet losses, and the connection will have other more</td><td> </td><td class="right">   multiple packet losses, and the connection will have other more</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   serious operational problems than using an inflated RTTM in the RTO</td><td> </td><td class="right">   serious operational problems than using an inflated RTTM in the RTO</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   calculation.</td><td> </td><td class="right">   calculation.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Appendix G.  Changes from RFC 1072, RFC 1185, and RFC 1323</td><td> </td><td class="right">Appendix G.  Changes from RFC 1072, RFC 1185, and RFC 1323</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The protocol extensions defined in RFC 1323 document differ in</td><td> </td><td class="right">   The protocol extensions defined in RFC 1323 document differ in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   several important ways from those defined in RFC 1072 and RFC 1185.</td><td> </td><td class="right">   several important ways from those defined in RFC 1072 and RFC 1185.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (a)  SACK has been split off into a separate document, [RFC2018].</td><td> </td><td class="right">   (a)  SACK has been split off into a separate document, [RFC2018].</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (b)  The detailed rules for sending timestamp replies (see</td><td> </td><td class="right">   (b)  The detailed rules for sending timestamp replies (see</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0086" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        Section 4.4) differ in important ways.  The earlier rules could</td><td> </td><td class="rblock">      Section 4.4) differ in important ways.  The earlier rules could</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        result in an under-estimate of the RTT in certain cases (packets</td><td> </td><td class="rblock">      result in an under-estimate of the RTT in certain cases (packets</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        dropped or out of order).</td><td> </td><td class="rblock">      dropped or out of order).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (c)  The same value TS.Recent is now shared by the two distinct</td><td> </td><td class="right">   (c)  The same value TS.Recent is now shared by the two distinct</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0087" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        mechanisms RTTM and PAWS.  This simplification became possible</td><td> </td><td class="rblock">      mechanisms RTTM and PAWS.  This simplification became possible</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        because of change (b).</td><td> </td><td class="rblock">      because of change (b).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (d)  An ambiguity in RFC 1185 was resolved in favor of putting</td><td> </td><td class="right">   (d)  An ambiguity in RFC 1185 was resolved in favor of putting</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0088" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        timestamps on ACK as well as data segments.  This supports the</td><td> </td><td class="rblock">      timestamps on ACK as well as data segments.  This supports the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        symmetry of the underlying TCP protocol.</td><td> </td><td class="rblock">      symmetry of the underlying TCP protocol.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (e)  The echo and echo reply options of RFC 1072 were combined into a</td><td> </td><td class="right">   (e)  The echo and echo reply options of RFC 1072 were combined into a</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0089" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        single Timestamps option, to reflect the symmetry and to</td><td> </td><td class="rblock">      single Timestamps option, to reflect the symmetry and to simplify</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        simplify processing.</td><td> </td><td class="rblock">      processing.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (f)  The problem of outdated timestamps on long-idle connections,</td><td> </td><td class="right">   (f)  The problem of outdated timestamps on long-idle connections,</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0090" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      <span class="delete">  </span>discussed in Section 5.2.2, was realized and resolved.</td><td> </td><td class="rblock">      discussed in Section 5.2.2, was realized and resolved.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (g)  RFC 1185 recommended that header prediction take precedence over</td><td> </td><td class="right">   (g)  RFC 1185 recommended that header prediction take precedence over</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0091" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        the timestamp check.  Based upon some skepticism about the</td><td> </td><td class="rblock">      the timestamp check.  Based upon some skepticism about the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        probabilistic arguments given in Section 5.2.4, it was decided</td><td> </td><td class="rblock">      probabilistic arguments given in Section 5.2.4, it was decided to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        to recommend that the timestamp check be performed first.</td><td> </td><td class="rblock">      recommend that the timestamp check be performed first.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (h)  The spec was modified so that the extended options will be sent</td><td> </td><td class="right">   (h)  The spec was modified so that the extended options will be sent</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0092" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        on &lt;SYN,ACK&gt; segments only when they are received in the</td><td> </td><td class="rblock">      on &lt;SYN,ACK&gt; segments only when they are received in the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        corresponding &lt;SYN&gt; segments.  This provides the most</td><td> </td><td class="rblock">      corresponding &lt;SYN&gt; segments.  This provides the most conservative</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        conservative possible conditions for interoperation with</td><td> </td><td class="rblock">      possible conditions for interoperation with implementations</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        implementations without the extensions.</td><td> </td><td class="rblock">      without the extensions.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   In addition to these substantive changes, the present RFC attempts to</td><td> </td><td class="right">   In addition to these substantive changes, the present RFC attempts to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   specify the algorithms unambiguously by presenting modifications to</td><td> </td><td class="right">   specify the algorithms unambiguously by presenting modifications to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the Event Processing rules of RFC 793; see Appendix E.</td><td> </td><td class="right">   the Event Processing rules of RFC 793; see Appendix E.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   There are additional changes in this document from RFC 1323.  These</td><td> </td><td class="right">   There are additional changes in this document from RFC 1323.  These</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   changes are:</td><td> </td><td class="right">   changes are:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (a)  The description of which TSecr values can be used to update the</td><td> </td><td class="right">   (a)  The description of which TSecr values can be used to update the</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0093" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        measured RTT has been clarified.  Specifically, with Timestamps,</td><td> </td><td class="rblock">      measured RTT has been clarified.  Specifically, with Timestamps,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        the Karn algorithm [Karn87] is disabled.  The Karn algorithm</td><td> </td><td class="rblock">      the Karn algorithm [Karn87] is disabled.  The Karn algorithm</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        disables all RTT measurements during retransmission, since it is</td><td> </td><td class="rblock">      disables all RTT measurements during retransmission, since it is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        ambiguous whether the ACK is for the original packet, or the</td><td> </td><td class="rblock">      ambiguous whether the ACK is for the original packet, or the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        retransmitted packet.  With Timestamps, that ambiguity is</td><td> </td><td class="rblock">      retransmitted packet.  With Timestamps, that ambiguity is removed</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        removed since the TSecr in the ACK will contain the TSval from</td><td> </td><td class="rblock">      since the TSecr in the ACK will contain the TSval from whichever</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        whichever data packet made it to the destination.</td><td> </td><td class="rblock">      data packet made it to the destination.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (b)  In RFC1323, section 3.4, step (2) of the algorithm to control</td><td> </td><td class="right">   (b)  In RFC1323, section 3.4, step (2) of the algorithm to control</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0094" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      <span class="delete">  </span>which timestamp is echoed was incorrect in two regards:</td><td> </td><td class="rblock">      which timestamp is echoed was incorrect in two regards:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0095" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        (1)  It failed to update TS.recent for a retransmitted segment</td><td> </td><td class="rblock">      (1)  It failed to update TS.recent for a retransmitted segment</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">             that resulted from a lost ACK.</td><td> </td><td class="rblock">            that resulted from a lost ACK.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0096" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      <span class="delete">  </span>(2)  It failed if SEG.LEN = 0.</td><td> </td><td class="rblock">      (2)  It failed if SEG.LEN = 0.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0097" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        In the new algorithm, the case of SEG.TSval &gt;= TS.recent is</td><td> </td><td class="rblock">      In the new algorithm, the case of SEG.TSval &gt;= TS.recent is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        included for consistency with the PAWS test.</td><td> </td><td class="rblock">      included for consistency with the PAWS test.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (c)  One correction was made to the Event Processing Summary in</td><td> </td><td class="right">   (c)  One correction was made to the Event Processing Summary in</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0098" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        Appendix E.  In SEND CALL/ESTABLISHED STATE, RCV.WND is used to</td><td> </td><td class="rblock">      Appendix E.  In SEND CALL/ESTABLISHED STATE, RCV.WND is used to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        fill in the SEG.WND value, not SND.WND.</td><td> </td><td class="rblock">      fill in the SEG.WND value, not SND.WND.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (d)  New pseudo-code summary has been added in Appendix D.</td><td> </td><td class="right">   (d)  New pseudo-code summary has been added in Appendix D.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (e)  Appendix A has been expanded with information about the TCP MSS</td><td> </td><td class="right">   (e)  Appendix A has been expanded with information about the TCP MSS</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0099" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      <span class="delete">  </span>option and the TCP Urgent Pointer.</td><td> </td><td class="rblock">      option and the TCP Urgent Pointer.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (f)  It is now recommended that Timestamps options be included in RST</td><td> </td><td class="right">   (f)  It is now recommended that Timestamps options be included in RST</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0100" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      <span class="delete">  </span>packets if the incoming packet contained a Timestamps option.</td><td> </td><td class="rblock">      packets if the incoming packet contained a Timestamps option.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (g)  RST packets are explicitly excluded from PAWS processing.</td><td> </td><td class="right">   (g)  RST packets are explicitly excluded from PAWS processing.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (h)  Snd.TSoffset and Snd.TSclock variables have been added.</td><td> </td><td class="right">   (h)  Snd.TSoffset and Snd.TSclock variables have been added.</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0101" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        Snd.TSclock is the sum of my.TSclock and Snd.TSoffset.  This</td><td> </td><td class="rblock">      Snd.TSclock is the sum of my.TSclock and Snd.TSoffset.  This</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        allows the starting points for timestamps to be randomized on a</td><td> </td><td class="rblock">      allows the starting points for timestamps to be randomized on a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        per-connection basis.  Setting Snd.TSoffset to zero yields the</td><td> </td><td class="rblock">      per-connection basis.  Setting Snd.TSoffset to zero yields the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        same results as [RFC1323].</td><td> </td><td class="rblock">      same results as [RFC1323].</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (i)  RTTM update processing explicitly excludes packets containing</td><td> </td><td class="right">   (i)  RTTM update processing explicitly excludes packets containing</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0102" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        SACK options.  This addresses inflation of the RTT during</td><td> </td><td class="rblock">      SACK options.  This addresses inflation of the RTT during episodes</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        episodes of packet loss in both directions.</td><td> </td><td class="rblock">      of packet loss in both directions.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (j)  In Section 4.2 the if-clause allowing sending of timestamps only</td><td> </td><td class="right">   (j)  In Section 4.2 the if-clause allowing sending of timestamps only</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0103" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        when received in a &lt;SYN&gt; or &lt;SYN,ACK&gt; was removed, to allow for</td><td> </td><td class="rblock">      when received in a &lt;SYN&gt; or &lt;SYN,ACK&gt; was removed, to allow for</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        late timestamp negotiation.</td><td> </td><td class="rblock">      late timestamp negotiation.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (k)  Section 3.4 was added describing the unavoidable window</td><td> </td><td class="right">   (k)  Section 3.4 was added describing the unavoidable window</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0104" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        retraction issue, and explicitly describing the mitigation steps</td><td> </td><td class="rblock">      retraction issue, and explicitly describing the mitigation steps</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        necessary.</td><td> </td><td class="rblock">      necessary.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (l)  Section 2 was added for RFC2119 wording.  Normative text was</td><td> </td><td class="right">   (l)  Section 2 was added for RFC2119 wording.  Normative text was</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0105" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      <span class="delete">  </span>updated with the appropriate phrases.</td><td> </td><td class="rblock">      updated with the appropriate phrases.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (m)  Removed much of the discussion in Section 1 to streamline the</td><td> </td><td class="right">   (m)  Removed much of the discussion in Section 1 to streamline the</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0106" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        document.  However, detailed examples and discussions in</td><td> </td><td class="rblock">      document.  However, detailed examples and discussions in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        Section 3, Section 4 and Section 5 are kept as guideline for</td><td> </td><td class="rblock">      Section 3, Section 4 and Section 5 are kept as guideline for</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">        implementers.</td><td> </td><td class="rblock">      implementers.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (n)  Moved Appendix "Changes" at the end of the appendices for easier</td><td> </td><td class="right">   (n)  Moved Appendix "Changes" at the end of the appendices for easier</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0107" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      <span class="delete">  </span>lookup.</td><td> </td><td class="rblock">      lookup.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Authors' Addresses</td><td> </td><td class="right">Authors' Addresses</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   David Borman</td><td> </td><td class="right">   David Borman</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Quantum Corporation</td><td> </td><td class="right">   Quantum Corporation</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Mendota Heights  MN 55120</td><td> </td><td class="right">   Mendota Heights  MN 55120</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   USA</td><td> </td><td class="right">   USA</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Email: david.borman@quantum.com</td><td> </td><td class="right">   Email: david.borman@quantum.com</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l19" /><small>skipping to change at</small><em> page 43, line 33</em></th><th> </th><th><a name="part-r19" /><small>skipping to change at</small><em> page 43, line 38</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Packet Design</td><td> </td><td class="right">   Packet Design</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   2465 Latham Street</td><td> </td><td class="right">   2465 Latham Street</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Mountain View  CA 94040</td><td> </td><td class="right">   Mountain View  CA 94040</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   USA</td><td> </td><td class="right">   USA</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Email: van@packetdesign.com</td><td> </td><td class="right">   Email: van@packetdesign.com</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Richard Scheffenegger (editor)</td><td> </td><td class="right">   Richard Scheffenegger (editor)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   NetApp, Inc.</td><td> </td><td class="right">   NetApp, Inc.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Am Euro Platz 2</td><td> </td><td class="right">   Am Euro Platz 2</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0108" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Vienna<span class="delete">, </span>  1120</td><td> </td><td class="rblock">   Vienna  1120</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Austria</td><td> </td><td class="right">   Austria</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Email: rs@netapp.com</td><td> </td><td class="right">   Email: rs@netapp.com</td><td class="lineno" valign="top"></td></tr>

     <tr><td></td><td class="left"></td><td> </td><td class="right"></td><td></td></tr>
     <tr bgcolor="gray"><th colspan="5" align="center"><a name="end">&nbsp;End of changes. 108 change blocks.&nbsp;</a></th></tr>
     <tr class="stats"><td></td><th><i>417 lines changed or deleted</i></th><th><i> </i></th><th><i>412 lines changed or added</i></th><td></td></tr>
     <tr><td colspan="5" align="center" class="small"><br/>This html diff was produced by rfcdiff 1.41. The latest version is available from <a href="http://www.tools.ietf.org/tools/rfcdiff/" >http://tools.ietf.org/tools/rfcdiff/</a> </td></tr>
   </table>
   </body>
   </html>
